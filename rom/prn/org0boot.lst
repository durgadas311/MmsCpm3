			maclib	z80
**** z80.lib ****
**** org0boot.asm ****
		
00F0          	?h8pt	equ	0f0h
00F2          	?port	equ	0f2h
		
3000          		org	3000h
3000  C30530  	boot:	jmp	around
		
3003  0000    	entry:	dw	0	; set by server net boot
		
3005          	around:
3005  F3      		di
3006  3E9F    		mvi	a,09fh	; 2ms off, blank fp on H8
3008  D3F0    		out	?h8pt	; H89 NMI should be innocuous
		
			; In case this is a MMS77318, use full un-lock
300A  211C30  		lxi	h,?code		;sequence to move memory-map
300D  0607    		mvi	b,?code$len	;number of bytes in sequence
300F  0EF2    		mvi	c,?port		;I/O port to send sequence
3011  EDB3    		outir
3013  2B      		dcx	h
3014  7E      		mov	a,m
3015  320D00  		sta	000dh	; for CP/M
		
3018  2A0330  		lhld	entry
301B  E9      		pchl
		
301C  04      	?code	db	0000$01$00b
301D  0C      		db	0000$11$00b
301E  04      		db	0000$01$00b
301F  08      		db	0000$10$00b
3020  0C      		db	0000$11$00b
3021  08      		db	0000$10$00b
3022  20      		db	0010$00$00b	;changes memory if "-FA" also
0007          	?code$len equ	$-?code
		
3023  00000000		rept	128-($-boot)
      00000000
      00000000
      00000000
      00000000
      00000000
      00000000
      00000000
      00000000
      00000000
      00000000
      00000000
      00000000
      00000000
      00000000
      00000000
      00000000
      00000000
      00000000
      00000000
      00000000
      00000000
      00000000
      00
		
3080          		end



Statistics:

     4	passes
     0	jr promotions
    12	symbols
   128	bytes

    94	macro calls
  3756	macro bytes
     0	invented symbols
