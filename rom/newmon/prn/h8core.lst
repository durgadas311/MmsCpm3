		; H8 Z80-CPU v3.2 Monitor (EEPROM 28C256)
0020          	VERN	equ	020h	; ROM version
		
0000          	false	equ	0
FFFF          	true	equ	not false
		
0000          	alpha	equ	0
0006          	beta	equ	6
		
0000          	z180	equ	false
0000          	h8nofp	equ	false
0000          	h89	equ	false
0000          	nofp	set	false
		
			maclib	ram
**** ram.lib ****
**** h8core.asm ****
			maclib	setup
**** setup.lib ****
**** h8core.asm ****
0000          	if z180
		else	; Z80 based
FF80          	pcode	set	0ff80h
			maclib	z80
**** z80.lib ****
**** h8core.asm ****
0000          	if h8nofp
		endif
0000          	if h89
		endif
		endif	; z180 else z80
		
0000          	if h8nofp or h89
		endif
			$*macro
		
000D          	CR	equ	13
000A          	LF	equ	10
0007          	BEL	equ	7
0009          	TAB	equ	9
0008          	BS	equ	8
001B          	ESC	equ	27
0000          	TRM	equ	0
007F          	DEL	equ	127
		
		; ctrl port F2 bit definitions
0002          	ctl$CLK		equ	00000010b	; enable H89 2mS clock (not used here)
0008          	ctl$MEM1	equ	00001000b	; maps full ROM (if !ORG0)
0020          	ctl$ORG0	equ	00100000b	; maps full RAM
0080          	ctl$IO1		equ	10000000b	; enables EEPROM write
		
0000          	if z180
		else
		; H8-512K MMU
0000          	mmu	equ	0	; base port
0000          	rd	equ	0
0004          	wr	equ	4
0000          	pg0k	equ	0
0001          	pg16k	equ	1
0002          	pg32k	equ	2
0003          	pg48k	equ	3
0080          	ena	equ	80h
0000          	rd00k	equ	mmu+rd+pg0k
0001          	rd16k	equ	mmu+rd+pg16k
0002          	rd32k	equ	mmu+rd+pg32k
0003          	rd48k	equ	mmu+rd+pg48k
0004          	wr00k	equ	mmu+wr+pg0k
0005          	wr16k	equ	mmu+wr+pg16k
0006          	wr32k	equ	mmu+wr+pg32k
0007          	wr48k	equ	mmu+wr+pg48k
		endif
		
3000          	memtest	equ	03000h
C000          	ramboot	equ	0c000h
		; fudge this... H17 junk
1F5A          	R$CONST	equ	01f5ah	; 037.132 R.CONST block...
1C19          	CLOCK	equ	01c19h	; 034.031 CLOCK
		
		; offsets in a module
0000          	mdpgs	equ	0	; num pages
0001          	mdorg	equ	1	; ORG for module (run/load addr)
0002          	mdbase	equ	2	; base phy drv num
0003          	mdluns	equ	3	; num LUNs
0004          	mdinit	equ	4	; init entry point
0007          	mdboot	equ	7	; boot entry point
000A          	mdchr	equ	10	; device letter
000B          	mdkey	equ	11	; device key
000C          	mdport	equ	12	; device port, 0 if variable
000D          	mddisp	equ	13	; boot front panel mnemonic
0010          	mdname	equ	16	; boot string
		
0000          	if z180
		else
2000          	btmods	equ	2000h	; boot modules start in ROM
8000          	bterom	equ	8000h	; end/size of ROM
		endif
		
0010          	rptcnt	equ	16
0001          	debounce equ	1
		
		; Start of ROM code
0000          		org	00000h
		
0000          	rombeg:
0000          	rst0:
0000          	if nofp
		else
0000  F3      		di	; can't be JMP or Heath CP/M thinks we're an H89
0001  C32D03  		jmp	init
		endif
		
0004  C30A02  		jmp	getport
0007  00      		db	0
		
0008  CD6D00  	rst1:	call	intsetup
000B  2A1B20  		lhld	ticcnt
000E  C36100  		jmp	int1$cont
0000          	if ((high int1$cont) <> 0)
		endif
		
0010          	rst2	equ	$-1	; must be a nop...
0011  CD6D00  		call	intsetup
0014  1A      		ldax	d
0015  C39001  		jmp	int2$cont
		
0018  C32520  	rst3:	jmp	vrst3
		
001B  C3B309  		jmp	crlf
001E  0000    		db	0,0
		
0020  C32820  	rst4:	jmp	vrst4
		
0023  000000  		db	0,0,0	; overlayed by WizNet boot, others
0026  C203    		dw	conout	; pointer, not vector; A=char
		
0028  C32B20  	rst5:	jmp	vrst5
		
002B  C33002  		jmp	delay
002E  3F00    	qmsg:	db	'?',TRM
		
0030  C32E20  	rst6:	jmp	vrst6
		
0033  00000000		db	0,0,0,0,0	; overlayed by WizNet boot, others
      00
		
0038  C33120  	rst7:	jmp	vrst7
		
		; routines made public (to modules)
003B  C32003  		jmp	hwboot	; 003b
003E  C32403  		jmp	hxboot	; 003e
0041  C39F01  		jmp	take$A	; 0041
0044  C3BD09  		jmp	msgout	; 0044
0047  C3950D  		jmp	linin	; 0047
		
004A          	intret:
004A  F1      		pop	psw
004B  F1      		pop	psw
004C  C1      		pop	b
004D  D1      		pop	d
004E  E1      		pop	h
004F          		popix
004F  DDE1    		DB	0DDH,0E1H
0051          		popiy
0051  FDE1    		DB	0FDH,0E1H
0053          		exx
0053  D9      		DB	0D9H
0054          		exaf
0054  08      		DB	08H
0055  C1      		pop	b	; I,R - R cannot be restored
0056  78      		mov	a,b
0057          		stai
0057  ED47    		DB	0EDH,47H
0059  F1      		pop	psw
005A  C1      		pop	b
005B  D1      		pop	d
005C  E1      		pop	h
005D          		exx
005D  D9      		DB	0D9H
005E          		exaf
005E  08      		DB	08H
005F          	nulint:
005F  FB      		ei
0060  C9      		ret
		
0000          	if nofp
		endif
		
0061          	int1$cont:
0061  23      		inx	h
0062  221B20  		shld	ticcnt
0065  3A3620  		lda	ctl$F2
0068  D3F2    		out	0f2h
0000          	if nofp
		else
006A  C3510B  		jmp	int1$fp
		endif
		
006D          	intsetup:
006D          		exx
006D  D9      		DB	0D9H
006E          		exaf
006E  08      		DB	08H
006F  E3      		xthl	; HL=PC (ret adr)
0070  D5      		push	d
0071  C5      		push	b
0072  F5      		push	psw
0073          		ldar
0073  ED5F    		DB	0EDH,5FH
0075  4F      		mov	c,a
0076          		ldai
0076  ED57    		DB	0EDH,57H
0078  47      		mov	b,a
0079  C5      		push	b
007A          		pushiy
007A  FDE5    		DB	0FDH,0E5H
007C          		pushix
007C  DDE5    		DB	0DDH,0E5H
007E  E5      		push	h	; save PC
007F          		exx
007F  D9      		DB	0D9H
0080          		exaf
0080  08      		DB	08H
0081  E3      		xthl		; HL=PC
0082  D5      		push	d
0083  C5      		push	b
0084  F5      		push	psw
0085  EB      		xchg		; DE=PC
0086  211800  		lxi	h,nReg-2
0089  39      		dad	sp
008A  E5      		push	h
008B  D5      		push	d	; save PC
008C  110920  		lxi	d,ctl$F0
008F  1A      		ldax	d
0090  2F      		cma
0091  E630    		ani	030h
0093  C8      		rz
0094  210200  		lxi	h,2
0097  39      		dad	sp
0098  221D20  		shld	monstk	; a.k.a. RegPtr
009B  C9      		ret
		
009C          	re$entry:		; re-entry point for errors, etc.
009C  210920  		lxi	h,ctl$F0
009F  36F0    		mvi	m,0f0h	; !beep, 2mS, MON, !SI
00A1  2A1D20  		lhld	monstk
00A4  F9      		sphl
00A5  CDC003  		call	belout	; TODO: beep front panel if appropriate
			;jmp	start
00A8          	start:
00A8  21A800  		lxi	h,start
00AB  E5      		push	h
			; reset FP display... this doesn't make a lot of sense...
00AC  3A0720  		lda	DspMod
00AF  E601    		ani	00000001b
00B1  2F      		cma
00B2  320620  		sta	DsProt
00B5  FB      		ei
			; avoid prompt if last was keypad command...
00B6  21A606  		lxi	h,prompt
00B9  3A3B20  		lda	lstcmd
00BC  B7      		ora	a
00BD  F4BD09  		cp	msgout
00C0          	prloop:
			; could take one of two paths here,
			; console or kaypad...
00C0  CDEC09  		call	cmdin
00C3  E6DF    		ani	11011111b ; toupper
00C5  323B20  		sta	lstcmd
FFFF          	if not nofp
00C8  FAFB08  		jm	kpcmd	; from keypad... jumps back here...
		endif
00CB  21DB00  	cmchr:	lxi	h,cmdtab
00CE  061C    		mvi	b,numcmd
00D0          	cmloop:
00D0  BE      		cmp	m
00D1  23      		inx	h
00D2          		jrz	docmd
00D2  2866    		DB	28H,docmd-$-1
00D4  23      		inx	h
00D5  23      		inx	h
00D6          		djnz	cmloop
00D6  10F8    		DB	10H,cmloop-$-1
00D8  C3DA06  		jmp	nocmd
		
00DB          	cmdtab:
			; console commands
00DB  44      		db	'D' !
00DC  F70D    	 dw cmddmp	; Dump memory
00DE  47      		db	'G' !
00DF  6701    	 dw cmdgo	; Go
00E1  53      		db	'S' !
00E2  6703    	 dw cmdsub	; Substitute in memory
00E4  50      		db	'P' !
00E5  4301    	 dw cmdpc	; Set PC
00E7  42      		db	'B' !
00E8  5702    	 dw cmdboot; Boot
00EA  4D      		db	'M' !
00EB  6804    	 dw cmdmt	; Memory Test
00ED  54      		db	'T' !
00EE  DF0E    	 dw termod	; Terminal Mode
00F0  56      		db	'V' !
00F1  340F    	 dw prtver	; Version of ROM
00F3  4C      		db	'L' !
00F4  350E    	 dw cmdlb	; List boot modules
00F6  48      		db	'H' !
00F7  720E    	 dw cmdhb	; long list (Help) boot modules
00F9  41      		db	'A' !
00FA  DD0E    	 dw cmdab	; Add boot module
00FC  55      		db	'U' !
00FD  DE0E    	 dw cmdur	; Update entire ROM
FFFF          	if not nofp
			; front-panel commands    key(old)  command/action
00FF  80      		db	80h !
0100  0307    	 dw kpubt	; [0]     - Universal Boot
0102  81      		db	81h !
0103  C307    	 dw kppbt	; [1]     - Pri Boot
0105  82      		db	82h !
0106  FD07    	 dw kpsbt	; [2]     - Sec Boot
0108  83      		db	83h !
0109  5C08    	 dw kprdx	; [3]     - Radix Mode
010B  84      		db	84h !
010C  1F06    	 dw kpgo	; [4]     - Go
010E  85      		db	85h !
010F  2806    	 dw kpin	; [5]     - Input
0111  86      		db	86h !
0112  3206    	 dw kpout	; [6]     - Output
0114  87      		db	87h !
0115  4206    	 dw kpsst	; [7]     - Single Step
0117  88      		db	88h !
0118  4B08    	 dw kptap	; [8]     - Cass Load
011A  89      		db	89h !
011B  4B08    	 dw kptap	; [9]     - Cass Store
011D  8A      		db	8ah !
011E  9508    	 dw kpnxt	; [A] [+] - Next
0120  8B      		db	8bh !
0121  AD08    	 dw kpprv	; [B] [-] - Prev
0123  8C      		db	8ch !
0124  3806    	 dw kpabt	; [C] [*] - CANCEL, usually
0126  8D      		db	8dh !
0127  3906    	 dw kprw	; [D] [/] - Display/Alter
0129  8E      		db	8eh !
012A  C808    	 dw kpmem	; [E] [#] - Memory Mode
012C  8F      		db	8fh !
012D  DD08    	 dw kprgm	; [F] [.] - Register Mode
		endif
001C          	numcmd	equ	($-cmdtab)/3
		
0000          	if nofp
		endif
		
			rept	0137h-$
012F  FF      		db	0ffh
0130  FF      		db	0ffh
0131  FF      		db	0ffh
0132  FF      		db	0ffh
0133  FF      		db	0ffh
0134  FF      		db	0ffh
0135  FF      		db	0ffh
0136  FF      		db	0ffh
0000          	if	($ <> 0137h)
		endif
0137  C30000  		jmp	0	; initialized by H47 boot module
		
0000          	if nofp
		endif
		
013A          	docmd:
013A  B7      		ora	a
013B  F4C203  		cp	conout
013E  4E      		mov	c,m
013F  23      		inx	h
0140  66      		mov	h,m
0141  69      		mov	l,c
0142  E9      	icall:	pchl
		
		;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
		; PC command (set PC)
0143          	cmdpc:
0143  21C006  		lxi	h,pcms
0146  CDBD09  		call	msgout
0149  2A1D20  		lhld	RegPtr
014C  111800  		lxi	d,24	; Reg[PC]
014F  19      		dad	d
0150  5E      		mov	e,m
0151  23      		inx	h
0152  56      		mov	d,m
0153  2B      		dcx	h
0154  EB      		xchg		; HL=PC, DE=adr to store
0155  CDB003  		call	inhexcr
0158          		jrc	cmdpc0	; hex digit entered
0158  3807    		DB	38H,cmdpc0-$-1
015A  CD2004  		call	adrnl	; show current PC (HL)
015D  CDB003  		call	inhexcr	; get another char
0160  D0      		rnc	; CR entered, don't update value
0161          	cmdpc0:
0161  EB      		xchg	; HL=adr to store
0162          	cmdpc1:
0162  160D    		mvi	d,CR
0164  C3CD03  		jmp	adrin
		;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
		
		;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
		; Go command
0167          	cmdgo:
0167  21B206  		lxi	h,goms
016A  CDBD09  		call	msgout
016D  2A1D20  		lhld	RegPtr
0170  111800  		lxi	d,24	; Reg[PC]
0173  19      		dad	d	; HL=adr to store
0174  CDB003  		call	inhexcr
0177  DC6201  		cc	cmdpc1	; read HEX until CR, store in HL
017A  CDB309  		call	crlf
FFFF          	if not nofp
			; TODO: make single-step work on H8
017D  3ED0    		mvi	a,0d0h	; no-beep, 2mS, !MON, !single-step
017F          		jr	cmdgo0
017F  1808    		DB	18H,cmdgo0-$-1
0181  F3      		di	; TODO: dead code? single-step...
0182  3A0920  		lda	ctl$F0
0185  EE10    		xri	010h	; toggle single-step
0187  D3F0    		out	0f0h
		else
		endif
0189          	cmdgo0:
0189  320920  		sta	ctl$F0
018C  E1      		pop	h
018D  C34A00  		jmp	intret
		;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
		
0190          	int2$cont:
FFFF          	if not nofp
0190  F610    		ori	010h	; disable single-step
0192  D3F0    		out	0f0h
0194  12      		stax	d
0195  E620    		ani	020h	; MON active?
		else
		endif
0197  C2A800  		jnz	start	; break to monitor code
019A  C32220  		jmp	vrst2	; else chain to (possible) user code.
		
019D          	take$5:
019D  3E05    		mvi	a,5	; 5 seconds
019F          	take$A:	; set a timeout for A seconds
019F  21AF01  		lxi	h,timeout
01A2  222020  		shld	vrst1+1
01A5  325221  		sta	SEC$CNT
01A8  3E01    		mvi	a,1
01AA  320820  		sta	MFlag
01AD  FB      		ei
01AE  C9      		ret
		
01AF          	timeout:
01AF  211B20  		lxi	h,ticcnt
01B2  AF      		xra	a
01B3  B6      		ora	m
01B4  C0      		rnz
01B5  23      		inx	h
01B6  7E      		mov	a,m
01B7  0F      		rrc
01B8  D8      		rc
			; every 512 ticks... 1024mS
01B9  215221  		lxi	h,SEC$CNT
01BC  35      		dcr	m
01BD  C0      		rnz
01BE          	error:
01BE  2A1D20  		lhld	monstk
01C1  F9      		sphl
01C2  212E00  		lxi	h,qmsg
01C5  CDBD09  		call	msgout	; A=0 on return
01C8  215F00  		lxi	h,nulint
01CB  222020  		shld	vrst1+1
01CE  320820  		sta	MFlag	; A=0 from msgout
01D1  DBF2    		in	0f2h
01D3  E603    		ani	00000011b
01D5          		jrnz	error0
01D5  2002    		DB	20H,error0-$-1
01D7  D37F    		out	07fh	; clear H17 ctrl port (A=0)
01D9          	error0:
01D9  C39C00  		jmp	re$entry
		
		; determine device for port 078H
		; return phy drv number in D.
01DC          	gtdev1:
01DC  1600    		mvi	d,0	; Z17
01DE  DBF2    		in	0f2h
01E0          	gtdev0:
01E0  E603    		ani	00000011b	; port 078H device
01E2  C8      		rz		; Z17 (or Z37)
01E3  FE01    		cpi	01b
01E5  1605    		mvi	d,5
01E7  C8      		rz		; Z47
01E8  FE02    		cpi	10b
01EA  1603    		mvi	d,3	; Z67/MMS77320
01EC  C8      		rz
01ED  16FF    		mvi	d,0ffh
01EF  C9      		ret	; NZ
		
		; determine device for port 078H
		; return phy drv number in D.
01F0          	gtdev2:
01F0  162E    		mvi	d,46	; Z37
01F2  DBF2    		in	0f2h
01F4  0F      		rrc
01F5  0F      		rrc
01F6          		jr	gtdev0	; rest are same
01F6  18E8    		DB	18H,gtdev0-$-1
		
		; determine default boot device.
01F8          	gtdfbt:
01F8  110000  		lxi	d,0
01FB  DBF2    		in	0f2h
01FD  E670    		ani	01110000b	; default boot selection
01FF  FE20    		cpi	00100000b	; device at 07CH
0201          		jrz	gtdev1
0201  28D9    		DB	28H,gtdev1-$-1
0203  FE30    		cpi	00110000b	; device at 078H
0205          		jrz	gtdev2
0205  28E9    		DB	28H,gtdev2-$-1
0207  C3B70C  		jmp	gtdvtb		; get MMS device
		
		; Check SW501 for installed device.
		; C = desired port pattern, 00=Z17/Z37, 01=Z47, 10=Z67, 11=undefined
		; returns base I/O port adr in B.
020A          	getport:
020A  067C    		mvi	b,07ch
020C  DBF2    		in	0f2h
020E  E603    		ani	003h
0210  B9      		cmp	c
0211  C8      		rz
0212  0678    		mvi	b,078h
0214  DBF2    		in	0f2h
0216  0F      		rrc
0217  0F      		rrc
0218  E603    		ani	003h
021A  B9      		cmp	c
021B  C9      		ret	; let caller decide error handling (NZ)
		
021C  212502  	s501er:	lxi	h,s501ms
021F  CDBD09  		call	msgout
0222  C39C00  		jmp	re$entry
		
0225  20535731	s501ms:	db	' SW1 wrong',TRM
      2077726F
      6E6700
		
0230          	delay:
0230  E5      		push	h
0231  211B20  		lxi	h,ticcnt
0234  86      		add	m
0235          	delay0:
0235  BE      		cmp	m
0236          		jrnz	delay0
0236  20FD    		DB	20H,delay0-$-1
0238  E1      		pop	h
0239  C9      		ret
		
023A          	gotnum:	; Boot N... "N" in D
023A  D5      		push	d	; save unit num (E)
023B  4A      		mov	c,d
023C  06FF    		mvi	b,-1	; boot modules only
023E  21B00B  		lxi	h,bfnum
0241  CD3A0C  		call	bfind	; might have already been loaded...
0244  D1      		pop	d
0245  DABE01  		jc	error
0248  CDB202  		call	vfport
024B  DA1C02  		jc	s501er
			; convert phy drv to phy base + unit
024E  7A      		mov	a,d
024F          		ldx	d,mdbase
024F  DD5602  		DB	0DDH,d*8+46H,mdbase
0252  92      		sub	d
0253  5F      		mov	e,a	; always zero?
0254  C3F502  		jmp	goboot
		
0257          	cmdboot:
0257  21AD06  		lxi	h,bootms
025A  CDBD09  		call	msgout	; complete (B)oot
025D  3EC3    		mvi	a,0c3h
025F  328022  		sta	bootbf	; mark "no string"
0262  AF      		xra	a
0263  325021  		sta	cport
0266  318022  		lxi	sp,bootbf
0269  0E0D    		mvi	c,CR	; end input on CR
026B          		jr	boot0
026B  1803    		DB	18H,boot0-$-1
026D          	bterr:
026D  CDC003  		call	belout
0270          	boot0:
0270  CDC609  		call	conin
0273  B9      		cmp	c
0274  CAFD0C  		jz	dfboot	; default boot, by phy drv...
0277  1E00    		mvi	e,0
			; boot by letter... Boot alpha-
0279  E65F    		ani	05fh ; toupper
027B  FE41    		cpi	'A'
027D          		jrc	bterr
027D  38EE    		DB	38H,bterr-$-1
027F  FE5B    		cpi	'Z'+1
0281          		jrnc	bterr
0281  30EA    		DB	30H,bterr-$-1
0283  FE41    		cpi	'A'
0285          		jrc	bterr
0285  38E6    		DB	38H,bterr-$-1
0287  CDC203  		call	conout
028A  CDC203  		call	conout
028D  FE42    		cpi	'B'
028F  DACA0C  		jc	A$boot	; 'A' is synonym for default
0292  C5      	gotit1:	push	b
0293  4F      		mov	c,a
0294  06FF    		mvi	b,-1	; boot modules only
0296  21940B  		lxi	h,bfchr
0299  CD3A0C  		call	bfind
029C  C1      		pop	b
029D  DABE01  		jc	error
02A0  CDB202  		call	vfport
02A3  DA1C02  		jc	s501er
02A6          		ldx	d,mdbase	; base phy drv num
02A6  DD5602  		DB	0DDH,d*8+46H,mdbase
02A9          	gotit:
02A9  1E00    		mvi	e,0
02AB  3E2D    		mvi	a,'-'	; next is optional unit number...
02AD  CDC203  		call	conout
02B0          		jr	luboot0
02B0  1815    		DB	18H,luboot0-$-1
		
		; verify port is set
		; IX=boot module (in memory)
02B2          	vfport:	ldx	a,mdport
02B2  DD7E0C  		DB	0DDH,a*8+46H,mdport
02B5  B7      		ora	a
02B6          		jrnz	vfp0
02B6  2007    		DB	20H,vfp0-$-1
02B8  3A5021  		lda	cport	; if btinit did not set, we can't go on
02BB  B7      		ora	a
02BC  C0      		rnz
02BD  37      		stc
02BE  C9      		ret
02BF  325021  	vfp0:	sta	cport
02C2  AF      		xra	a
02C3  C9      		ret
		
02C4          	lunerr:
02C4  CDC003  		call	belout
02C7          	luboot0:
02C7  CD0A04  		call	hexin
02CA          		jrnc	luboot2	; valid HEX digit...
02CA  300D    		DB	30H,luboot2-$-1
02CC  B9      		cmp	c
02CD          		jrz	goboot
02CD  2826    		DB	28H,goboot-$-1
02CF  FE3A    		cpi	':'
02D1          		jrz	colon
02D1  2815    		DB	28H,colon-$-1
02D3  FE20    		cpi	' '
02D5          		jrz	space
02D5  280C    		DB	28H,space-$-1
02D7          		jr	lunerr
02D7  18EB    		DB	18H,lunerr-$-1
02D9          	luboot2:
02D9  CDD50D  		call	E$x16$A
02DC          		jrc	lunerr
02DC  38E6    		DB	38H,lunerr-$-1
02DE  CDC203  		call	conout
02E1          		jr	luboot0
02E1  18E4    		DB	18H,luboot0-$-1
02E3          	space:
02E3  CDC203  		call	conout
02E6          		jr	luboot0	; TODO: this gets dodgy if spaces between digits.
02E6  18DF    		DB	18H,luboot0-$-1
		
02E8          	colon:	; get arbitrary string as last boot param
02E8  CDC203  		call	conout	; echo ':'
02EB  218122  		lxi	h,bootbf+1
02EE  CD950D  		call	linin
02F1  78      		mov	a,b	; excludes TRM
02F2  328022  		sta	bootbf	; bootbf: <len> <string...> as in CP/M cmd buf
		; D=Phys Drive base number, E=Unit number
		; (or, D=Phys Drive unit, E=0)
		; module must have already been loaded
		; NOTE: string might have been placed at bootbf...
		; SP was set to 'bootbf'...
02F5          	goboot:
02F5          		lxiy	error
02F5  FD21    		DB	0FDH,21H
02F7  BE01    		DW	error
02F9  CDB309  		call	crlf
		; IY=error routine
		; Move string to stack, if present.
		; Stack space is 292 bytes, be certain not to overrun.
		; Since len value is 127 max + TRM, should be OK.
		; Can't use stack until copy is done... can't destroy DE...
02FC          	gbooty:
02FC  218022  		lxi	h,bootbf
02FF  7E      		mov	a,m
0300  FEC3    		cpi	0c3h
0302          		jrz	gboot0
0302  280C    		DB	28H,gboot0-$-1
0304  4F      		mov	c,a	; length
0305  0600    		mvi	b,0
0307  23      		inx	h	; first byte of string...
0308  09      		dad	b	; point to end (TRM)
0309          	btstr1:
0309  7E      		mov	a,m
030A  F5      		push	psw
030B  33      		inx	sp	; undo half of push
030C  2B      		dcx	h
030D  0D      		dcr	c
030E          		jrnz	btstr1
030E  20F9    		DB	20H,btstr1-$-1
0310          	gboot0:
0310          		pushiy	; error routine
0310  FDE5    		DB	0FDH,0E5H
		; IX=boot module (in memory)
		; D=phy drv base, E=unit
0312          	doboot:	; common boot path for console and keypad
0312  CD7609  		call	h17init	; leaves interrupts disabled
0315  7B      		mov	a,e
0316  323121  		sta	AIO$UNI	; relative unit num
0319  7A      		mov	a,d
031A  323420  		sta	l2034h	; boot phys drv base
031D  C3990C  		jmp	btboot
			; btboot effectively returns here on success
			; (in most cases)
0320  AF      	hwboot:	xra	a
0321  320820  		sta	MFlag
0324  21191C  	hxboot:	lxi	h,CLOCK
0327  222020  		shld	vrst1+1
032A  C38022  		jmp	bootbf
		
		; ROM start point - initialize everything
		; We know we have at least 64K RAM...
		; But, right now, ROM is in 0000-7FFF so must copy
		; core code and switch to RAM...
032D          	init:
0000          	if z180
		else
032D  21FFFF  		lxi	h,0ffffh
0330  F9      		sphl
0331  E5      		push	h	; save top on stack
0332  3E08    		mvi	a,ctl$MEM1	; MEM1 = full ROM
0334  D3F2    		out	0f2h	; enable full ROM
0336  3A0811  		lda	suadr+m512k
0339  B7      		ora	a
033A  CC630D  		cz	savram	; H8-512K installed, save RAM
033D  210000  		lxi	h,0
0340  110000  		lxi	d,0
0343  010020  		lxi	b,2000h	; copy everything?
0346          		ldir
0346  EDB0    		DB	0EDH,0B0H
		endif
			; save config data
0348  210010  		lxi	h,suadr
034B  1100F8  		lxi	d,susave
034E  010F01  		lxi	b,sumax
0351          		ldir
0351  EDB0    		DB	0EDH,0B0H
0353  219C00  		lxi	h,re$entry
0356  E5      		push	h
0357  CD4204  		call	coninit
035A  CD5106  		call	meminit
035D  CF      		rst	1	; kick-start clock
035E  21490F  		lxi	h,signon
0361  CDBD09  		call	msgout
			; save registers on stack, for debugger access...
0364  C36D00  		jmp	intsetup
		
		;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
		; Substitute command
0367          	cmdsub:
0367  21B506  		lxi	h,subms
036A  CDBD09  		call	msgout
036D  211420  		lxi	h,ABUSS
0370  B7      		ora	a	; NC
0371  160D    		mvi	d,CR
0373  CDCD03  		call	adrin
0376  EB      		xchg
0377          	cmdsub0:
0377  CD2004  		call	adrnl
037A  7E      		mov	a,m
037B  CD2F04  		call	hexout
037E  CD2B04  		call	spout
0381          	cmdsub1:
0381  CD0A04  		call	hexin
0384          		jrnc	cmdsub4
0384  3019    		DB	30H,cmdsub4-$-1
0386  FE0D    		cpi	CR
0388          		jrz	cmdsub2
0388  280C    		DB	28H,cmdsub2-$-1
038A  FE2D    		cpi	'-'
038C          		jrz	cmdsub3
038C  280B    		DB	28H,cmdsub3-$-1
038E  FE2E    		cpi	'.'
0390  C8      		rz
0391  CDC003  		call	belout
0394          		jr	cmdsub1
0394  18EB    		DB	18H,cmdsub1-$-1
0396          	cmdsub2:
0396  23      		inx	h
0397          		jr	cmdsub0
0397  18DE    		DB	18H,cmdsub0-$-1
0399          	cmdsub3:
0399  CDC203  		call	conout
039C  2B      		dcx	h
039D          		jr	cmdsub0
039D  18D8    		DB	18H,cmdsub0-$-1
039F          	cmdsub4:
039F  3600    		mvi	m,000h
03A1          	cmdsub5:
03A1  CDC203  		call	conout
03A4  CD0104  		call	hexbin
03A7          		rld
03A7  ED6F    		DB	0EDH, 6FH
03A9  CDB003  		call	inhexcr
03AC          		jrnc	cmdsub2
03AC  30E8    		DB	30H,cmdsub2-$-1
03AE          		jr	cmdsub5
03AE  18F1    		DB	18H,cmdsub5-$-1
		
03B0          	inhexcr:
03B0  CDC609  		call	conin
03B3  FE0D    		cpi	CR
03B5  C8      		rz
03B6  CD0D04  		call	hexchk
03B9  3F      		cmc
03BA  D8      		rc
03BB  CDC003  		call	belout
03BE          		jr	inhexcr
03BE  18F0    		DB	18H,inhexcr-$-1
		
03C0          	belout:
03C0  3E07    		mvi	a,BEL
03C2          	conout:
03C2  F5      		push	psw
03C3          	conot1:
03C3  DBED    		in	0edh
03C5  E620    		ani	00100000b
03C7          		jrz	conot1
03C7  28FA    		DB	28H,conot1-$-1
03C9  F1      		pop	psw
03CA  D3E8    		out	0e8h
03CC  C9      		ret
		
		; D=term char (e.g. '.' for Substitute)
		; HL=location to store address
		; CY=first digit in A
03CD          	adrin:
03CD  E5      		push	h	; adr to store value
03CE  D4C609  		cnc	conin
03D1  BA      		cmp	d	; no input?
03D2  CA1A06  		jz	adrin3
03D5  210000  		lxi	h,0
03D8  37      		stc
03D9  D4C609  	adrin0:	cnc	conin
03DC  CD0D04  		call	hexchk
03DF          		jrc	adrin1
03DF  380E    		DB	38H,adrin1-$-1
03E1  CDC203  		call	conout
03E4  CD0104  		call	hexbin
03E7  29      		dad	h
03E8  29      		dad	h
03E9  29      		dad	h
03EA  29      		dad	h
03EB  B5      		ora	l
03EC  6F      		mov	l,a
03ED          		jr	adrin0
03ED  18EA    		DB	18H,adrin0-$-1
03EF          	adrin1:
03EF  BA      		cmp	d
03F0          		jrz	adrin2
03F0  2806    		DB	28H,adrin2-$-1
03F2  CDC003  		call	belout
03F5  B7      		ora	a
03F6          		jr	adrin0
03F6  18E1    		DB	18H,adrin0-$-1
03F8          	adrin2:
03F8  CDC203  		call	conout
03FB  EB      		xchg
03FC  E1      		pop	h
03FD  73      		mov	m,e
03FE  23      		inx	h
03FF  72      		mov	m,d
0400  C9      		ret
		
0401          	hexbin:
0401  D63A    		sui	'9'+1
0403          		jrnc	hexbi0
0403  3002    		DB	30H,hexbi0-$-1
0405  C607    		adi	7
0407          	hexbi0:
0407  C603    		adi	3
0409  C9      		ret
		
040A          	hexin:
040A  CDC609  		call	conin
040D          	hexchk:
040D  FE30    		cpi	'0'
040F  D8      		rc
0410  FE3A    		cpi	'9'+1
0412  3F      		cmc
0413  D0      		rnc
0414  FE41    		cpi	'A'
0416  D8      		rc
0417  E65F    		ani	05fh	; toupper
0419  FE41    		cpi	'A'
041B  D8      		rc
041C  FE47    		cpi	'F'+1
041E  3F      		cmc
041F  C9      		ret
		
		; HL = adr to print
0420          	adrnl:
0420  CDB309  		call	crlf
0423          	adrout:
0423  7C      		mov	a,h
0424  CD2F04  		call	hexout
0427  7D      		mov	a,l
0428  CD2F04  		call	hexout
042B          	spout:
042B  3E20    		mvi	a,' '
042D          		jr	conout
042D  1893    		DB	18H,conout-$-1
		
042F          	hexout:
042F  F5      		push	psw
0430  07      		rlc
0431  07      		rlc
0432  07      		rlc
0433  07      		rlc
0434  CD3804  		call	hexdig
0437  F1      		pop	psw
0438          	hexdig:
0438  E60F    		ani	00fh
043A  C690    		adi	090h
043C  27      		daa
043D  CE40    		aci	040h
043F  27      		daa
0440          		jr	conout
0440  1880    		DB	18H,conout-$-1
		
0442          	coninit:
0442  0E0C    		mvi	c,12	; 9600 baud
0444  DBF2    		in	0f2h
0446  E680    		ani	10000000b	; 9600/19.2K?
0448          		jrz	ci0
0448  2802    		DB	28H,ci0-$-1
044A  0E06    		mvi	c,6	; 19.2K baud
044C  3E83    	ci0:	mvi	a,083h
044E  D3EB    		out	0ebh
0450  AF      		xra	a
0451  D3E9    		out	0e9h
0453  79      		mov	a,c
0454  D3E8    		out	0e8h
0456  3E03    		mvi	a,003h
0458  D3EB    		out	0ebh
045A  AF      		xra	a
045B  D3E9    		out	0e9h
045D  3E0F    		mvi	a,00001111b	; OUT2=1 hides 16C2550 intr enable diff
045F  D3EC    		out	0ech
0461  C9      		ret
		
		;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
		; Memory Test command
		
0462          	cserr:
0462  218C06  		lxi	h,cserms
0465  C3BD09  		jmp	msgout
		
0468          	cmdmt:
0468  21CD06  		lxi	h,mtms
046B  CDBD09  		call	msgout
046E  CDAC09  		call	waitcr
0471  219906  		lxi	h,topms
0474  CDBD09  		call	msgout
0477  210000  		lxi	h,0
047A  39      		dad	sp
047B  7C      		mov	a,h
047C  3C      		inr	a
047D          		jrz	cmdmt0
047D  2802    		DB	28H,cmdmt0-$-1
047F  D620    		sui	020h
0481          	cmdmt0:
0481  67      		mov	h,a
0482  2E00    		mvi	l,0
0484  2B      		dcx	h
0485  D630    		sui	'0'
0487  5F      		mov	e,a
0488  CD2304  		call	adrout
048B  CDB309  		call	crlf
048E  1600    		mvi	d,000h
0490  0E30    		mvi	c,030h
0492  0600    		mvi	b,000h
0494          		exx
0494  D9      		DB	0D9H
0495  21BF04  		lxi	h,mtest0
0498  11FC2F  		lxi	d,memtest - (mtest1-mtest0)
049B  01F000  		lxi	b,mtestZ-mtest0
049E          		ldir
049E  EDB0    		DB	0EDH,0B0H
04A0  110030  		lxi	d,memtest
04A3  21C304  		lxi	h,mtest1
04A6  0EEC    		mvi	c,mtestZ-mtest1
04A8  AF      		xra	a
04A9          		exaf
04A9  08      		DB	08H
04AA  AF      		xra	a
04AB          	cmdmt1:
04AB  86      		add	m
04AC          		exaf
04AC  08      		DB	08H
04AD  EB      		xchg
04AE  86      		add	m
04AF          		exaf
04AF  08      		DB	08H
04B0  EB      		xchg
04B1  23      		inx	h
04B2  13      		inx	d
04B3  0D      		dcr	c
04B4          		jrnz	cmdmt1
04B4  20F5    		DB	20H,cmdmt1-$-1
04B6  4F      		mov	c,a
04B7          		exaf
04B7  08      		DB	08H
04B8  B9      		cmp	c
04B9          		jrnz	cserr
04B9  20A7    		DB	20H,cserr-$-1
04BB  F3      		di
04BC  C3FC2F  		jmp	memtest - (mtest1-mtest)
		
		;------------------------------------------------
		; Start of relocated code...
		; Memory Test routine, position-independent
		;
04BF          	mtest0:
04BF          	mtest:
04BF  3E20    		mvi	a,ctl$ORG0	; ORG0 on (ROM off)
04C1  D3F2    		out	0f2h
04C3          	mtest1:		; lands at 03000h - retained relocated code
04C3          		exx
04C3  D9      		DB	0D9H
04C4  62      		mov	h,d
04C5  2E00    		mvi	l,0
04C7  78      		mov	a,b
04C8          		exx
04C8  D9      		DB	0D9H
04C9  4F      		mov	c,a
04CA  0602    		mvi	b,2
04CC          	mtest2:
04CC  79      		mov	a,c
04CD  07      		rlc
04CE  07      		rlc
04CF  07      		rlc
04D0  07      		rlc
04D1  4F      		mov	c,a
04D2  E60F    		ani	00fh
04D4  C690    		adi	090h
04D6  27      		daa
04D7  CE40    		aci	040h
04D9  27      		daa
04DA  D3E8    		out	0e8h
04DC          	mtest3:
04DC  DBED    		in	0edh
04DE  E620    		ani	020h
04E0          		jrz	mtest3
04E0  28FA    		DB	28H,mtest3-$-1
04E2  05      		dcr	b
04E3          		jrnz	mtest2
04E3  20E7    		DB	20H,mtest2-$-1
04E5  3E0D    		mvi	a,CR
04E7  D3E8    		out	0e8h
04E9          		exx
04E9  D9      		DB	0D9H
04EA  78      		mov	a,b
04EB          	mtest4:
04EB  77      		mov	m,a
04EC  C601    		adi	1
04EE  27      		daa
04EF  2C      		inr	l
04F0          		jrnz	mtest4
04F0  20F9    		DB	20H,mtest4-$-1
04F2  24      		inr	h
04F3  0D      		dcr	c
04F4          		jrnz	mtest4
04F4  20F5    		DB	20H,mtest4-$-1
04F6  7C      		mov	a,h
04F7  92      		sub	d
04F8  4F      		mov	c,a
04F9  62      		mov	h,d
04FA  2E00    		mvi	l,0
04FC  78      		mov	a,b
04FD          	mtest5:
04FD  BE      		cmp	m
04FE          		jrnz	mtest9
04FE  2046    		DB	20H,mtest9-$-1
0500  C601    		adi	1
0502  27      		daa
0503  2C      		inr	l
0504          		jrnz	mtest5
0504  20F7    		DB	20H,mtest5-$-1
0506  24      		inr	h
0507  0D      		dcr	c
0508          		jrnz	mtest5
0508  20F3    		DB	20H,mtest5-$-1
050A          		exx
050A  D9      		DB	0D9H
050B  210030  		lxi	h,memtest
050E  110000  		lxi	d,0
0511  01EC00  		lxi	b,mtestZ-mtest1
0514          		exx
0514  D9      		DB	0D9H
0515  7A      		mov	a,d
0516  EE30    		xri	030h
0518  57      		mov	d,a
0519          		jrz	mtest6
0519  2803    		DB	28H,mtest6-$-1
051B  4B      		mov	c,e
051C          		jr	mtest7
051C  180A    		DB	18H,mtest7-$-1
051E          	mtest6:
051E  0E30    		mvi	c,030h
0520  3E01    		mvi	a,001h
0522  80      		add	b
0523  27      		daa
0524  47      		mov	b,a
0525          		exx
0525  D9      		DB	0D9H
0526  EB      		xchg
0527          		exx
0527  D9      		DB	0D9H
0528          	mtest7:
0528          		exx
0528  D9      		DB	0D9H
0529          		ldir
0529  EDB0    		DB	0EDH,0B0H
052B  7A      		mov	a,d
052C  E6F0    		ani	0f0h
052E  67      		mov	h,a
052F  2E00    		mvi	l,0
0531  0EEC    		mvi	c,mtestZ-mtest1
0533  AF      		xra	a
0534          	mtest8:
0534  86      		add	m
0535  23      		inx	h
0536  0D      		dcr	c
0537          		jrnz	mtest8
0537  20FB    		DB	20H,mtest8-$-1
0539  4F      		mov	c,a
053A          		exaf
053A  08      		DB	08H
053B  B9      		cmp	c
053C          		jrnz	mtestE
053C  2049    		DB	20H,mtestE-$-1
053E          		exaf
053E  08      		DB	08H
053F  7A      		mov	a,d
0540  E6F0    		ani	0f0h
0542  67      		mov	h,a
0543  2E00    		mvi	l,0
0545  E9      		pchl
0546          	mtest9:
0546  AE      		xra	m
0547  57      		mov	d,a
0548  3E0A    		mvi	a,LF
054A  D3E8    		out	0e8h
054C          	mtestA:
054C  DBED    		in	0edh
054E  E620    		ani	020h
0550          		jrz	mtestA
0550  28FA    		DB	28H,mtestA-$-1
0552  0E02    		mvi	c,2
0554  0604    		mvi	b,4
0556          	mtestB:
0556  7C      		mov	a,h
0557  07      		rlc
0558  07      		rlc
0559  07      		rlc
055A  07      		rlc
055B  E60F    		ani	00fh
055D  C690    		adi	090h
055F  27      		daa
0560  CE40    		aci	040h
0562  27      		daa
0563  D3E8    		out	0e8h
0565          	mtestC:
0565  DBED    		in	0edh
0567  E620    		ani	020h
0569          		jrz	mtestC
0569  28FA    		DB	28H,mtestC-$-1
056B  29      		dad	h
056C  29      		dad	h
056D  29      		dad	h
056E  29      		dad	h
056F          		djnz	mtestB
056F  10E5    		DB	10H,mtestB-$-1
0571  3E20    		mvi	a,' '
0573  D3E8    		out	0e8h
0575          	mtestD:
0575  DBED    		in	0edh
0577  E620    		ani	020h
0579          		jrz	mtestD
0579  28FA    		DB	28H,mtestD-$-1
057B  0D      		dcr	c
057C  EB      		xchg
057D  0602    		mvi	b,002h
057F          		jrnz	mtestB
057F  20D5    		DB	20H,mtestB-$-1
0581  3E2A    		mvi	a,'*'
0583  D3E8    		out	0e8h
0585          		jr	mtestG
0585  1814    		DB	18H,mtestG-$-1
0587          	mtestE:
0587  DBED    		in	0edh
0589  E620    		ani	020h
058B          		jrz	mtestE
058B  28FA    		DB	28H,mtestE-$-1
058D  3E0A    		mvi	a,LF
058F  D3E8    		out	0e8h
0591          	mtestF:
0591  DBED    		in	0edh
0593  E620    		ani	020h
0595          		jrz	mtestF
0595  28FA    		DB	28H,mtestF-$-1
0597  3E21    		mvi	a,'!'
0599  D3E8    		out	0e8h
059B          	mtestG:
059B  DBED    		in	0edh
059D  E620    		ani	020h
059F          		jrz	mtestG
059F  28FA    		DB	28H,mtestG-$-1
05A1  AF      		xra	a
05A2  06FA    		mvi	b,0fah
05A4          	mtestH:
05A4  3D      		dcr	a
05A5          		jrnz	mtestH
05A5  20FD    		DB	20H,mtestH-$-1
05A7          		djnz	mtestH
05A7  10FB    		DB	10H,mtestH-$-1
05A9  3E07    		mvi	a,BEL
05AB  D3E8    		out	0e8h
05AD          		jr	mtestG
05AD  18EC    		DB	18H,mtestG-$-1
		; End of relocated code
05AF          	mtestZ	equ	$
		;------------------------------------------------
		
		; must be called with interrupts off
		; A = horn delay, in 2mS ticks
		; A,HL used
05AF          	set$horn:
05AF  323C20  		sta	horn
05B2  210920  		lxi	h,ctl$F0
05B5          		res	7,m	; beep on
05B5  CBBE    		DB	0CBH,7*8+m+80H
05B7  7E      		mov	a,m
05B8  D3F0    		out	0f0h
05BA  C9      		ret
		
		; must be called with interrupts enabled
		; A = horn delay, in 2mS ticks
		; A,HL used
05BB          	set$horn0:
05BB  F3      		di
05BC  CDAF05  		call	set$horn
05BF  FB      		ei
05C0  C9      		ret
		
		; Special entry points expected by HDOS, or maybe Heath CP/M boot.
			rept	0613h-$
05C1  FF      		db	0ffh
05C2  FF      		db	0ffh
05C3  FF      		db	0ffh
05C4  FF      		db	0ffh
05C5  FF      		db	0ffh
05C6  FF      		db	0ffh
05C7  FF      		db	0ffh
05C8  FF      		db	0ffh
05C9  FF      		db	0ffh
05CA  FF      		db	0ffh
05CB  FF      		db	0ffh
05CC  FF      		db	0ffh
05CD  FF      		db	0ffh
05CE  FF      		db	0ffh
05CF  FF      		db	0ffh
05D0  FF      		db	0ffh
05D1  FF      		db	0ffh
05D2  FF      		db	0ffh
05D3  FF      		db	0ffh
05D4  FF      		db	0ffh
05D5  FF      		db	0ffh
05D6  FF      		db	0ffh
05D7  FF      		db	0ffh
05D8  FF      		db	0ffh
05D9  FF      		db	0ffh
05DA  FF      		db	0ffh
05DB  FF      		db	0ffh
05DC  FF      		db	0ffh
05DD  FF      		db	0ffh
05DE  FF      		db	0ffh
05DF  FF      		db	0ffh
05E0  FF      		db	0ffh
05E1  FF      		db	0ffh
05E2  FF      		db	0ffh
05E3  FF      		db	0ffh
05E4  FF      		db	0ffh
05E5  FF      		db	0ffh
05E6  FF      		db	0ffh
05E7  FF      		db	0ffh
05E8  FF      		db	0ffh
05E9  FF      		db	0ffh
05EA  FF      		db	0ffh
05EB  FF      		db	0ffh
05EC  FF      		db	0ffh
05ED  FF      		db	0ffh
05EE  FF      		db	0ffh
05EF  FF      		db	0ffh
05F0  FF      		db	0ffh
05F1  FF      		db	0ffh
05F2  FF      		db	0ffh
05F3  FF      		db	0ffh
05F4  FF      		db	0ffh
05F5  FF      		db	0ffh
05F6  FF      		db	0ffh
05F7  FF      		db	0ffh
05F8  FF      		db	0ffh
05F9  FF      		db	0ffh
05FA  FF      		db	0ffh
05FB  FF      		db	0ffh
05FC  FF      		db	0ffh
05FD  FF      		db	0ffh
05FE  FF      		db	0ffh
05FF  FF      		db	0ffh
0600  FF      		db	0ffh
0601  FF      		db	0ffh
0602  FF      		db	0ffh
0603  FF      		db	0ffh
0604  FF      		db	0ffh
0605  FF      		db	0ffh
0606  FF      		db	0ffh
0607  FF      		db	0ffh
0608  FF      		db	0ffh
0609  FF      		db	0ffh
060A  FF      		db	0ffh
060B  FF      		db	0ffh
060C  FF      		db	0ffh
060D  FF      		db	0ffh
060E  FF      		db	0ffh
060F  FF      		db	0ffh
0610  FF      		db	0ffh
0611  FF      		db	0ffh
0612  FF      		db	0ffh
0000          	if	($ <> 0613h)
		endif
0613  C30000  		jmp	0	; initialized by H47 boot module
0616  00      		db	0
0617  C30000  		jmp	0	; initialized by H47 boot module
		
0000          	if z180
		endif
		
061A  E1      	adrin3:	pop	h
061B  5E      		mov	e,m
061C  23      		inx	h
061D  56      		mov	d,m
061E  C9      		ret
		
FFFF          	if not nofp
061F          	kpgo:
061F  3ED0    		mvi	a,11010000b	; MON off
0621  320920  		sta	ctl$F0
0624  E1      		pop	h	; discard ret adr
0625  C34A00  		jmp	intret	; execute
		
0628  2A1420  	kpin:	lhld	ABUSS
062B  4C      		mov	c,h	; port
062C          		inp	l	; get value
062C  ED68    		DB	0EDH,l*8+40H
062E  221420  		shld	ABUSS
0631  C9      		ret
		
0632  2A1420  	kpout:	lhld	ABUSS
0635  4C      		mov	c,h	; port
0636          		outp	l	; output value
0636  ED69    		DB	0EDH,l*8+41H
0638  C9      	kpabt:	ret
		
0639          	kprw:	; switch between display/modify
0639  3A0720  		lda	DspMod
063C  EE01    		xri	1
063E  320720  		sta	DspMod
0641  C9      		ret
		
0642          	kpsst:	; single-step one instruction
0642  F3      		di
0643  3A0920  		lda	ctl$F0
0646  EE10    		xri	00010000b	; disable SS inhibit
0648  D3F0    		out	0f0h
064A  320920  	sst1:	sta	ctl$F0
064D  E1      		pop	h	; discard ret adr
064E  C34A00  		jmp	intret	; execute
		endif
		
		; initialize monitor memory at 2000h
0651          	meminit:
0651  AF      		xra	a
0652  325321  		sta	l2153h
0655  323B20  		sta	lstcmd
0658  320520  		sta	RegI
065B  320620  		sta	DsProt
065E  320720  		sta	DspMod
0661  323920  		sta	Radix
0664  323A20  		sta	kpchar
0667  323C20  		sta	horn
066A  3C      		inr	a	; 1
066B  320A20  		sta	Refind
0000          	if nofp
		else
066E  3E20    		mvi	a,ctl$ORG0	; ORG0 on, 2mS off...
		endif
0670  323620  		sta	ctl$F2	; 2mS off, ORG0 on
0673  D3F2    		out	0f2h	; enable RAM now...
0675  3EC9    		mvi	a,0c9h	; RET
0677  320420  		sta	PrsRAM
067A  210050  		lxi	h,05000h	; 0, (beep, 2mS, !MON, !SI)
067D  220820  		shld	MFlag	; MFlag, CtlFlg
0680  21FFFF  		lxi	h,0ffffh	; top of memory
0683  221420  		shld	ABUSS
0686  3E01    		mvi	a,debounce
0688  321720  		sta	kpcnt
068B  C9      		ret
		
		; for cmdmt...
068C  07436B73	cserms:	db	BEL,'Cksum error',TRM
      756D2065
      72726F72
      00
0699  546F7020	topms:	db	'Top of Mem: ',TRM
      6F66204D
      656D3A20
      00
		
06A6  0D0A4838	prompt:	db	CR,LF,'H8'
0000          	if h8nofp
		endif
0000          	if h89
		endif
06AA  3A2000  		db	': ',TRM
06AD  6F6F7420	bootms:	db	'oot ',TRM
      00
06B2  6F2000  	goms:	db	'o ',TRM
06B5  75627374	subms:	db	'ubstitute ',TRM
      69747574
      652000
06C0  726F6720	pcms:	db	'rog Counter ',TRM
      436F756E
      74657220
      00
06CD  656D2074	mtms:	db	'em test',TRM
      65737400
06D5  756D7020	dmpms:	db	'ump ',TRM
      00
		
		; command not built-in, check modules.
		; should only be called for console commands.
		; A=cmd key/chr (also in 'lstcmd')
06DA          	nocmd:
06DA  4F      		mov	c,a
06DB  0600    		mvi	b,0	; no boot modules
06DD  21940B  		lxi	h,bfchr
06E0  CD3A0C  		call	bfind
06E3          		jrc	cmerr
06E3  3809    		DB	38H,cmerr-$-1
06E5  3A3B20  		lda	lstcmd
06E8  CDC203  		call	conout
06EB  C3990C  		jmp	cmexec
		
06EE  CDC003  	cmerr:	call	belout
06F1  C3C000  		jmp	prloop
		
FFFF          	if not nofp
		; get "alternate" (secondary) boot device...
06F4          	galtbt:
06F4  110000  		lxi	d,0
06F7  DBF2    		in	0f2h
06F9  E670    		ani	01110000b	; default boot selection
06FB  FE20    		cpi	00100000b	; if default at 07CH,
06FD  CAF001  		jz	gtdev2		; get 078H device...
		; if device was not 07CH, then use 07CH... ???
		;;	cpi	00110000b	; if device at 078H
		;;	jz	gtdev1		; get 07CH device...
0700  C3DC01  		jmp	gtdev1		; get 07CH device...
		
0703          	kpubt:
0703  3A0820  		lda	MFlag
0706  F602    		ori	00000010b	; disable disp updates
0708  320820  		sta	MFlag
070B  CD430B  		call	clrdisp	; clean slate
070E  01FC0A  		lxi	b,dDev
0711  110B20  		lxi	d,ALeds
0714  CD390B  		call	mov3dsp
0717  CDDE09  		call	keyin	; get device
071A  E67F    		ani	01111111b
071C  FE0C    		cpi	0ch	; cancel
071E  CA7B07  		jz	kperr
0721  325121  		sta	BDF
0724  4F      		mov	c,a
0725  06FF    		mvi	b,-1	; boot modules only
0727  21A20B  		lxi	h,bfkey
072A  CD3A0C  		call	bfind
072D          		jrc	deverr
072D  384C    		DB	38H,deverr-$-1
072F  DD      		db	0ddh !
0730  44      	 mov b,h	; mov b,IXh ; module address
0731  0E0D    		mvi	c,mddisp
0733  110B20  		lxi	d,ALeds
0736  CD390B  		call	mov3dsp
0739  D5      		push	d	; save LEDs pointer
			; determine if fixed port...
073A          		ldx	a,mdport
073A  DD7E0C  		DB	0DDH,a*8+46H,mdport
073D  B7      		ora	a
073E          		jrnz	gotprt
073E  2018    		DB	20H,gotprt-$-1
0740  01FF0A  		lxi	b,dPor
0743  CD390B  		call	mov3dsp
0746  CDDE09  		call	keyin	; get port
0749  E67F    		ani	01111111b
074B  FE04    		cpi	04h	; 0..3 allowed
074D  D27B07  		jnc	deverr
0750  5F      		mov	e,a
0751  1600    		mvi	d,0
0753  21BF07  		lxi	h,ports
0756  19      		dad	d
0757  7E      		mov	a,m
0758  E1      	gotprt:	pop	h	; LEDs pointer
0759  325021  		sta	cport
075C  CD700A  		call	dod	; decode number to HL
075F  54      		mov	d,h
0760  5D      		mov	e,l
0761  01020B  		lxi	b,dUni
0764  CD390B  		call	mov3dsp
0767  CDDE09  		call	keyin	; get unit
076A  E67F    		ani	01111111b
076C  5F      		mov	e,a
076D          		ldx	d,mdbase
076D  DD5602  		DB	0DDH,d*8+46H,mdbase
0770  3EC3    		mvi	a,0c3h
0772  328022  		sta	bootbf	; mark "no string"
0775  318022  		lxi	sp,bootbf
0778  CD1203  		call	doboot	; only returns if error...
077B          	kperr:
077B          	deverr:
077B  FB      		ei	; TODO: more required before this?
077C  210820  		lxi	h,MFlag
077F  7E      		mov	a,m
0780  E6FE    		ani	11111110b	; disable "private" clock intr
0782  F602    		ori	00000010b	; disable disp updates
0784  77      		mov	m,a
0785  01050B  		lxi	b,dErr
0788  110B20  		lxi	d,ALeds
078B  2E06    		mvi	l,6
078D  CD3B0B  		call	movLdsp
0790  0E80    		mvi	c,10000000b	; beep on/off bit
0792  211B20  		lxi	h,ticcnt
0795  110920  		lxi	d,ctl$F0
0798          	bterr0:
0798  1A      		ldax	d
0799  A9      		xra	c	; beep on
079A  12      		stax	d
079B  7E      		mov	a,m
079C  C619    		adi	25	; 50mS
079E          	bterr2:
079E  BE      		cmp	m
079F          		jrnz	bterr2
079F  20FD    		DB	20H,bterr2-$-1
07A1  1A      		ldax	d
07A2  A9      		xra	c	; beep off
07A3  12      		stax	d
07A4  7E      		mov	a,m
07A5  C6FF    		adi	-1
07A7  BE      	bterr1:	cmp	m
07A8          		jrz	bterr0
07A8  28EE    		DB	28H,bterr0-$-1
07AA  3A3A20  		lda	kpchar
07AD  FE6F    		cpi	01101111b	; raw pattern for '*' or CANCEL
07AF          		jrnz	bterr1
07AF  20F6    		DB	20H,bterr1-$-1
07B1  AF      		xra	a
07B2  323A20  		sta	kpchar
07B5  210820  		lxi	h,MFlag
07B8  7E      		mov	a,m
07B9  E6BD    		ani	10111101b	; normal mode...
07BB  77      		mov	m,a
			; should return to 'start' but avoid extra prompts...
07BC  C39C00  		jmp	re$entry
		
		; port options for keys 0-3
07BF  787CB8BC	ports:	db	078h,07ch,0b8h,0bch
		
07C3          	kppbt:	; primary boot (default boot)
07C3  3EC3    		mvi	a,0c3h
07C5  328022  		sta	bootbf	; mark "no string"
07C8  010E0B  		lxi	b,dPri
07CB  CD3008  		call	btdsp
07CE  CDF801  		call	gtdfbt
07D1  7A      		mov	a,d
07D2  FEFF    		cpi	0ffh
07D4  CA7B07  		jz	kperr
07D7  FEFE    		cpi	0feh
07D9          		jrz	kppbt0
07D9  283E    		DB	28H,kppbt0-$-1
07DB          	kpbt0:
07DB  AF      		xra	a
07DC  325021  		sta	cport
07DF  D5      		push	d	; phy drv, unit
07E0  4A      		mov	c,d
07E1  06FF    		mvi	b,-1	; boot modules only
07E3  21B00B  		lxi	h,bfnum
07E6  CD3A0C  		call	bfind	; might have already been loaded...
07E9  DA7B07  		jc	kperr
07EC  CDB202  		call	vfport
07EF  DA7B07  		jc	kperr	; TODO: specific error? SW1 Error?
07F2  D1      		pop	d	; phy drv, unit
07F3  318022  		lxi	sp,bootbf
07F6  217B07  		lxi	h,kperr
07F9  E5      		push	h
07FA  C31203  		jmp	doboot
		
07FD          	kpsbt:	; secondary boot
07FD  3EC3    		mvi	a,0c3h
07FF  328022  		sta	bootbf	; mark "no string"
0802  01110B  		lxi	b,dSec
0805  CD3008  		call	btdsp
0808  2186F8  		lxi	h,susave+dsdev
080B  CD1B0D  		call	dfboot0
080E  DA7B07  		jc	kperr
0811  B7      		ora	a
0812          		jrz	kpbt1
0812  2812    		DB	28H,kpbt1-$-1
0814  CDF406  		call	galtbt
0817          		jr	kpbt0
0817  18C2    		DB	18H,kpbt0-$-1
		
0819  2104F8  	kppbt0:	lxi	h,susave+dpdev
081C  CD1B0D  		call	dfboot0
081F  DA7B07  		jc	kperr
0822  B7      		ora	a
0823  C27B07  		jnz	kperr
0826          	kpbt1:	lxiy	kperr
0826  FD21    		DB	0FDH,21H
0828  7B07    		DW	kperr
082A  318022  		lxi	sp,bootbf
082D  C3FC02  		jmp	gbooty
		
0830          	btdsp:
0830  3A0820  		lda	MFlag
0833  F602    		ori	00000010b	; disable disp updates
0835  320820  		sta	MFlag
0838  D5      		push	d
0839  C5      		push	b
083A  CD430B  		call	clrdisp
083D  C1      		pop	b
083E  110B20  		lxi	d,ALeds
0841  CD390B  		call	mov3dsp
			; TODO: fix this - is there a better way?
0844  3EFA    		mvi	a,250	;; make it briefly visible
0846  CD3002  		call	delay	;;
0849  D1      		pop	d
084A  C9      		ret
		
084B          	kptap:	; cassette load (read) or store (write, save)
084B  0600    		mvi	b,0	; command only
084D  0E88    		mvi	c,88h	; cassette module key
084F  21A20B  		lxi	h,bfkey
0852  CD3A0C  		call	bfind
0855  DA7B07  		jc	kperr
0858  CD990C  		call	cmexec
085B  C9      		ret
		
085C          	kprdx:	; choose radix for display
085C  3A0820  		lda	MFlag
085F  F602    		ori	00000010b	; disable disp updates
0861  320820  		sta	MFlag
0864  CD430B  		call	clrdisp
0867  010B0B  		lxi	b,dRad
086A  110B20  		lxi	d,ALeds
086D  CD390B  		call	mov3dsp
0870  3A3920  		lda	Radix
0873  B7      		ora	a
0874  2F      		cma		; 00->ff
0875          		jrz	rdx0
0875  2801    		DB	28H,rdx0-$-1
0877  AF      		xra	a	; else 00
0878  323920  	rdx0:	sta	Radix		; 00       ff
087B  E613    		ani	00010011b	; 00->00,  ff->13
087D  EE81    		xri	10000001b	; 00->81,  ff->92
087F  321020  		sta	ALeds+5		; 00->'O', ff->'H'
			; wait 1S to allow user to see...
0882  3EFA    		mvi	a,250		; 500mS
0884  CD3002  		call	delay
0887  3EFA    		mvi	a,250		; 500mS
0889  CD3002  		call	delay
088C  3A0820  		lda	MFlag
088F  E6FD    		ani	11111101b	; enable disp updates
0891  320820  		sta	MFlag
			; TODO: beep?
0894  C9      		ret
		
0895          	kpnxt:	; next register/memory addr
0895  3A0720  		lda	DspMod
0898  E602    		ani	00000010b	; Z if memory mode
089A  2A1420  		lhld	ABUSS
089D  110520  		lxi	d,RegI
08A0  23      		inx	h
08A1          		jrz	sae
08A1  2821    		DB	28H,sae-$-1
08A3  1A      		ldax	d
08A4  C602    		adi	2
08A6  12      		stax	d
08A7  FE1A    		cpi	nReg
08A9  D8      		rc
08AA  AF      		xra	a
08AB  12      		stax	d
08AC  C9      		ret
		
08AD          	kpprv:	; previous register/memory addr
08AD  3A0720  		lda	DspMod
08B0  E602    		ani	00000010b	; Z if memory mode
08B2  2A1420  		lhld	ABUSS
08B5  110520  		lxi	d,RegI
08B8  2B      		dcx	h
08B9          		jrz	sae
08B9  2809    		DB	28H,sae-$-1
08BB  1A      		ldax	d
08BC  D602    		sui	2
08BE  12      		stax	d
08BF  D0      		rnc
08C0  3E18    		mvi	a,nReg-2
08C2  12      		stax	d
08C3  C9      		ret
		
08C4  221420  	sae:	shld	ABUSS
08C7  C9      		ret
		
08C8          	kpmem:	; switch to memory mode - enter address
08C8  AF      		xra	a	; also NC
08C9  320720  		sta	DspMod	; display memory...
08CC  320620  		sta	DsProt	; periods all on...
08CF  211520  		lxi	h,ABUSS+1	; little-endian, enter hi byte first
08D2  CD3209  		call	iob
08D5  2B      		dcx	h	; HL=low byte of address
08D6  0600    		mvi	b,0
08D8  B7      		ora	a	; CY=0
08D9  CD3209  		call	iob
08DC  C9      		ret		; back to start... TODO: prevent re-prompt
		
08DD          	kprgm:	; switch to register mode
08DD  3E02    		mvi	a,2
08DF  320720  		sta	DspMod	; display registers...
08E2  AF      		xra	a
08E3  320620  		sta	DsProt	; periods all on...
08E6  CDDE09  		call	keyin
08E9  E67F    		ani	01111111b
08EB  FE0C    		cpi	(nReg-1)/2	; PC requires spcl
08ED          		jrc	reg0
08ED  3807    		DB	38H,reg0-$-1
08EF  D603    		sub	3		; gap in codes?
08F1  FE0C    		cpi	12		; was 15...
08F3  C27B07  		jnz	kperr	; TODO: proper handling
08F6  07      	reg0:	rlc	; times 2
08F7  320520  		sta	RegI
08FA  C9      		ret		; back to start... TODO: prevent re-prompt
		
08FB          	kpcmd:	; A=keypad command, +80h
			; keypad pressed...
08FB  FE8A    		cpi	8ah	; non-digit (hex req first be '0')
08FD  D2CB00  		jnc	cmchr
0900  47      		mov	b,a
0901  3A0720  		lda	DspMod
0904  0F      		rrc	; CY=alter mode
0905          		jrc	kpalter	; alter mode - numeric values only
0905  3804    		DB	38H,kpalter-$-1
0907  78      		mov	a,b
0908  C3CB00  		jmp	cmchr
		; A=DspMod >> 1, B=key
090B          	kpalter:
090B  2A1420  		lhld	ABUSS
090E  0F      		rrc	; register (else memory)
090F          		jrc	kpreg
090F  3809    		DB	38H,kpreg-$-1
0911  37      		stc
0912  CD3209  		call	iob
0915  23      		inx	h
0916  221420  		shld	ABUSS
0919  C9      		ret
		
		; B=key
091A          	kpreg:
091A  3A0520  		lda	RegI
091D  B7      		ora	a
091E  CA7B07  		jz	kperr	; RegI == 0 (SP) not allowed
0921  5F      		mov	e,a
0922  1600    		mvi	d,0
0924  2A1D20  		lhld	RegPtr
0927  19      		dad	d
0928  23      		inx	h	; HL=high byte of address
0929  37      		stc
092A  CD3209  		call	iob
092D  2B      		dcx	h	; HL=low byte of address
092E  CD3209  		call	iob
0931  C9      		ret
		
		; Input Octal(or Hex) byte
		; B=key, CY=first digit
0932          	iob:	rarr	c	; save CY => C bit 7
0932  CB19    		DB	0CBH, 18H + c
0934  3A3920  		lda	Radix
0937  B7      		ora	a
0938  78      		mov	a,b
0939          		jrz	ioboct
0939  2820    		DB	28H,ioboct-$-1
		; iobhex - to avoid conflict with cmd keys A-F, first input must be [0]
		; So, hex input requires 3 or 5 + 1 keys.
093B          		ralr	c	; restore CY
093B  CB11    		DB	0CBH, 10H+c
093D  D4DE09  		cnc	keyin
0940  E67F    		ani	01111111b
0942  C27B07  		jnz	kperr
0945  1602    		mvi	d,2
0947  CDDE09  	iobh0:	call	keyin
094A  E67F    		ani	01111111b
094C  5F      		mov	e,a
094D  7E      		mov	a,m
094E  07      		rlc
094F  07      		rlc
0950  07      		rlc
0951  07      		rlc
0952  E6F0    		ani	11110000b
0954  B3      		ora	e	; also ensure NC for loop
0955  77      		mov	m,a
0956  15      		dcr	d
0957          		jrnz	iobh0
0957  20EE    		DB	20H,iobh0-$-1
0959          		jr	iob0
0959  181A    		DB	18H,iob0-$-1
095B          	ioboct:
095B          		ralr	c	; restore CY
095B  CB11    		DB	0CBH, 10H+c
095D  1603    		mvi	d,3
095F  D4DE09  	iobo0:	cnc	keyin
0962  E67F    		ani	01111111b
0964  FE08    		cpi	8
0966  D27B07  		jnc	kperr
0969  5F      		mov	e,a
096A  7E      		mov	a,m
096B  07      		rlc
096C  07      		rlc
096D  07      		rlc
096E  E6F8    		ani	11111000b
0970  B3      		ora	e	; also ensure NC for loop
0971  77      		mov	m,a
0972  15      		dcr	d
0973          		jrnz	iobo0
0973  20EA    		DB	20H,iobo0-$-1
0975          	iob0:
			; TODO: blip to ack entry?
0975  C9      		ret
		endif
		
		; returns with interrupts disabled
		; preserves DE
0976          	h17init:
0976  F3      		di
0977  DBF2    		in	0f2h
0979  E603    		ani	00000011b	; port 7C - only one for H17
097B          		jrnz	h17in0
097B  2003    		DB	20H,h17in0-$-1
097D  AF      		xra	a
097E  D37F    		out	07fh	; avoid this if H17 not configured
0980  D5      	h17in0:	push	d
0981  210920  		lxi	h,ctl$F0
0984  36D0    		mvi	m,11010000b	; !beep, 2mS, !mon, !SI
0986  215A1F  		lxi	h,R$CONST
0989  114820  		lxi	d,D$CONST
098C  015800  		lxi	b,88
098F          		ldir
098F  EDB0    		DB	0EDH,0B0H
0991  6B      		mov	l,e
0992  62      		mov	h,d
0993  13      		inx	d
0994  0E1E    		mvi	c,30
0996  77      		mov	m,a
0997          		ldir	; fill l20a0h...
0997  EDB0    		DB	0EDH,0B0H
0999  3C      		inr	a	; A=1
099A  211F20  		lxi	h,intvec	; vector area
099D          	h17ini0:
099D  36C3    		mvi	m,0c3h
099F  23      		inx	h
09A0  365F    		mvi	m,LOW (nulint-rst0)
09A2  23      		inx	h
09A3  3600    		mvi	m,HIGH (nulint-rst0)
09A5  23      		inx	h
09A6  87      		add	a	; shift left, count 7
09A7  F29D09  		jp	h17ini0
09AA  D1      		pop	d
09AB  C9      		ret
		
09AC          	waitcr:
09AC  CDC609  		call	conin
09AF  FE0D    		cpi	CR
09B1          		jrnz	waitcr
09B1  20F9    		DB	20H,waitcr-$-1
09B3          	crlf:
09B3  3E0D    		mvi	a,CR
09B5  CDC203  		call	conout
09B8  3E0A    		mvi	a,LF
09BA  C3C203  		jmp	conout
		
09BD          	msgout:
09BD  7E      		mov	a,m
09BE  B7      		ora	a
09BF  C8      		rz
09C0  CDC203  		call	conout
09C3  23      		inx	h
09C4          		jr	msgout
09C4  18F7    		DB	18H,msgout-$-1
		
		; called in the context of a command on console
09C6  DBED    	conin:	in	0edh
09C8  0F      		rrc
0000          	if nofp
		else
09C9          		jrc	conin0
09C9  3809    		DB	38H,conin0-$-1
09CB  3A3A20  		lda	kpchar
09CE  B7      		ora	a
09CF          		jrz	conin
09CF  28F5    		DB	28H,conin-$-1
			; cancel console cmd, leave keypad char for cmdin
09D1  C3A800  		jmp	start
		endif
		
09D4  DBE8    	conin0:	in	0e8h
09D6  E67F    		ani	07fh
09D8  FE7F    		cpi	DEL	; DEL key restarts from anywhere?
09DA  CA9C00  		jz	re$entry
09DD  C9      		ret
		
FFFF          	if not nofp
		; called in the context of command on front-panel
09DE  3A3A20  	keyin:	lda	kpchar
09E1  B7      		ora	a
09E2          		jrnz	getkey
09E2  2013    		DB	20H,getkey-$-1
09E4  DBED    		in	0edh
09E6  0F      		rrc
09E7          		jrnc	keyin
09E7  30F5    		DB	30H,keyin-$-1
			; cancel kaypad cmd, leave console char for cmdin
			; TODO: what modes need reset?
09E9  C3A800  		jmp	start
		endif
		
		; wait for command - console or keypad
09EC          	cmdin:
09EC  DBED    		in	0edh
09EE  0F      		rrc
09EF          		jrc	conin0
09EF  38E3    		DB	38H,conin0-$-1
0000          	if nofp
		else
09F1  3A3A20  		lda	kpchar
09F4  B7      		ora	a
09F5          		jrz	cmdin
09F5  28F5    		DB	28H,cmdin-$-1
09F7  F5      	getkey:	push	psw	; A=scan code
09F8  AF      		xra	a
09F9  323A20  		sta	kpchar
09FC  F1      		pop	psw
09FD  EEFE    		xri	11111110b
09FF  0F      		rrc
0A00          		jrnc	gotkey
0A00  3004    		DB	30H,gotkey-$-1
0A02  0F      		rrc
0A03  0F      		rrc
0A04  0F      		rrc
0A05  0F      		rrc
0A06  E60F    	gotkey:	ani	00001111b
0A08  F680    		ori	10000000b	; distinguish from console input
			; TODO: check for CANCEL key?
0A0A  C9      		ret
		endif
		
FFFF          	if not nofp
		; keypad check at 32mS
0A0B  211620  	kpchk:	lxi	h,RckA
0A0E  DBF0    		in	0f0h
0A10  BE      		cmp	m	; RckA
0A11          		jrnz	kpchk0
0A11  2014    		DB	20H,kpchk0-$-1
0A13  E611    		ani	00010001b
0A15  FE11    		cpi	00010001b
0A17  C8      		rz	; nothing pressed
0A18  7E      		mov	a,m
			; need to count auto-repeat/debounce
0A19  23      		inx	h	; kpcnt
0A1A  35      		dcr	m
0A1B  C0      		rnz
			; got a key press...
0A1C  323A20  		sta	kpchar
0A1F  3610    		mvi	m,rptcnt
0A21  3E02    		mvi	a,4/2	; 4mS click
0A23  CDAF05  		call	set$horn
0A26  C9      		ret
0A27  77      	kpchk0:	mov	m,a	; RckA
0A28  23      		inx	h	; kpcnt
0A29  3601    		mvi	m,debounce
0A2B  C9      		ret
		
		; Update Front-panel Display
0A2C  3E02    	ufd:	mvi	a,00000010b
0A2E  A0      		ana	b
0A2F  C0      		rnz		; updates disabled
0A30  210620  		lxi	h,DsProt
0A33          		rlcr	m
0A33  CB06    		DB	0CBH, 00H + m
0A35  46      		mov	b,m
0A36  23      		inx	h	; DspMod
0A37  7E      		mov	a,m
0A38  E602    		ani	00000010b
0A3A  2A1420  		lhld	ABUSS
0A3D          		jrz	ufd1	; displaying memory
0A3D  2812    		DB	28H,ufd1-$-1
			; displaying registers
0A3F  CD2E0B  		call	lra	; locate register address offset (DE)
0A42  E5      		push	h
0A43  21140B  		lxi	h,LedRegTbl
0A46  19      		dad	d
0A47  7E      		mov	a,m
0A48  23      		inx	h
0A49  66      		mov	h,m
0A4A  6F      		mov	l,a
0A4B  E3      		xthl
0A4C  B4      		ora	h
0A4D  7E      		mov	a,m
0A4E  23      		inx	h
0A4F  66      		mov	h,m
0A50  6F      		mov	l,a
0A51  F5      	ufd1:	push	psw
0A52  EB      		xchg
0A53  210B20  		lxi	h,ALeds
0A56  7A      		mov	a,d
0A57  CD700A  		call	dod
0A5A  7B      		mov	a,e
0A5B  CD700A  		call	dod
0A5E  F1      		pop	psw
0A5F  1A      		ldax	d
0A60          		jrz	dod	; if displaying memory
0A60  280E    		DB	28H,dod-$-1
			; displaying register name
0A62  C1      		pop	b
0A63  111120  		lxi	d,DLeds
0A66  2E03    	mv3byt:	mvi	l,3
0A68  0A      	mvb:	ldax	b
0A69  12      		stax	d
0A6A  03      		inx	b
0A6B  13      		inx	d
0A6C  2D      		dcr	l
0A6D          		jrnz	mvb
0A6D  20F9    		DB	20H,mvb-$-1
0A6F  C9      		ret
		
		; B=dot flag
0A70  4F      	dod:	mov	c,a	; value to display
0A71  3A3920  		lda	Radix
0A74  B7      		ora	a	; Z if octal (also CY=0)
0A75  79      		mov	a,c
0A76          		jrnz	dodhex
0A76  2021    		DB	20H,dodhex-$-1
0A78  D5      		push	d
0A79  0E03    		mvi	c,3
0A7B  17      	dodr5:	ral
0A7C  17      		ral
0A7D  17      		ral
0A7E  F5      		push	psw
0A7F  E607    		ani	07h
0A81  C6C5    		adi	LOW doddig
0A83  5F      		mov	e,a
0A84  3E0A    		mvi	a,HIGH doddig
0A86  CE00    		aci	0
0A88  57      		mov	d,a
0A89  1A      		ldax	d
0A8A  A8      		xra	b	; DP on/off
0A8B  E67F    		and	01111111b	; why???
0A8D  A8      		xra	b
0A8E  77      		mov	m,a
0A8F  23      		inx	h
0A90  78      		mov	a,b	; rlcr b
0A91  07      		rlc
0A92  47      		mov	b,a
0A93  F1      		pop	psw
0A94  0D      		dcr	c
0A95          		jrnz	dodr5
0A95  20E4    		DB	20H,dodr5-$-1
0A97  D1      		pop	d
0A98  C9      		ret
		
0A99  D5      	dodhex:	push	d
0A9A  0E02    		mvi	c,2
0A9C  07      	deh55:	rlc
0A9D  07      		rlc
0A9E  07      		rlc
0A9F  07      		rlc
0AA0  F5      		push	psw
0AA1  E60F    		ani	0fh
0AA3  C6C5    		adi	LOW doddig
0AA5  5F      		mov	e,a
0AA6  3E0A    		mvi	a,HIGH doddig
0AA8  CE00    		aci	0
0AAA  57      		mov	d,a
0AAB  1A      		ldax	d
0AAC  A8      		xra	b		; DP on/off
0AAD  E67F    		ani	01111111b	; why???
0AAF  A8      		xra	b		; ???
0AB0  77      		mov	m,a
0AB1  23      		inx	h
0AB2          		rlcr	b
0AB2  CB00    		DB	0CBH, 00H + b
0AB4  F1      		pop	psw
0AB5  0D      		dcr	c
0AB6          		jrnz	deh55
0AB6  20E4    		DB	20H,deh55-$-1
0AB8  D1      		pop	d
0AB9  3E6F    		mvi	a,01101111b	; "_"
0ABB  A8      		xra	b		; DP on/off
0ABC  E67F    		ani	01111111b	; why???
0ABE  A8      		xra	b		; ???
0ABF  77      		mov	m,a
0AC0  23      		inx	h
0AC1  78      		mov	a,b	; rlcr b
0AC2  07      		rlc
0AC3  47      		mov	b,a
0AC4  C9      		ret
		
		; octal (base 8) 7-seg translation
0AC5  01      	doddig:	db	00000001b	; "0."
0AC6  73      		db	01110011b	; "1."
0AC7  48      		db	01001000b	; "2."
0AC8  60      		db	01100000b	; "3."
0AC9  32      		db	00110010b	; "4."
0ACA  24      		db	00100100b	; "5."
0ACB  04      		db	00000100b	; "6."
0ACC  71      		db	01110001b	; "7."
0ACD  00      		db	00000000b	; "8."
0ACE  20      		db	00100000b	; "9."
0ACF  10      		db	00010000b	; "A."
0AD0  06      		db	00000110b	; "b."
0AD1  0D      		db	00001101b	; "C."
0AD2  42      		db	01000010b	; "d."
0AD3  0C      		db	00001100b	; "E."
0AD4  1C      		db	00011100b	; "F."
		
0AD5  FFA498  	dSP:	db	11111111b,10100100b,10011000b	; " SP"
0AD8  FF909C  	dPSW:	db	11111111b,10010000b,10011100b	; " AF"
0ADB  FF868D  	dBC:	db	11111111b,10000110b,10001101b	; " BC"
0ADE  FFC28C  	dDE:	db	11111111b,11000010b,10001100b	; " DE"
0AE1  FF928F  	dHL:	db	11111111b,10010010b,10001111b	; " HL"
0AE4  FFF3B6  	dIX:	db	11111111b,11110011b,10110110b	; " IX"
0AE7  FFF3DE  	dIY:	db	11111111b,11110011b,11011110b	; " IY"
0AEA  FFF3D3  	dIR:	db	11111111b,11110011b,11010011b	; " IR"
0AED  909CBF  	dPSWp:	db	10010000b,10011100b,10111111b	; "AF'"
0AF0  868DBF  	dBCp:	db	10000110b,10001101b,10111111b	; "BC'"
0AF3  C28CBF  	dDEp:	db	11000010b,10001100b,10111111b	; "DE'"
0AF6  928FBF  	dHLp:	db	10010010b,10001111b,10111111b	; "HL'"
0AF9  FF98CE  	dPC:	db	11111111b,10011000b,11001110b	; " PC"
		
0AFC  C28C83  	dDev:	db	11000010b,10001100b,10000011b	; "dEU" (dev)
0AFF  98C6DE  	dPor:	db	10011000b,11000110b,11011110b	; "Por"
0B02  83D6F7  	dUni:	db	10000011b,11010110b,11110111b	; "Uni"
0B05  8CDEDE  	dErr:	db	10001100b,11011110b,11011110b	; "Error "
0B08  C6DEFF  		db	11000110b,11011110b,11111111b
0B0B  DE90C2  	dRad:	db	11011110b,10010000b,11000010b	; "rAd"
0B0E  98DEDF  	dPri:	db	10011000b,11011110b,11011111b	; "Pri"
0B11  A48C8D  	dSec:	db	10100100b,10001100b,10001101b	; "SEC"
		
0B14          	LedRegTbl:
0B14  D50A    		dw	dSP	; 0
0B16  D80A    		dw	dPSW	; 1
0B18  DB0A    		dw	dBC	; 2
0B1A  DE0A    		dw	dDE	; 3
0B1C  E10A    		dw	dHL	; 4
0B1E  E40A    		dw	dIX	; 5	- TODO
0B20  E70A    		dw	dIY	; 6	- TODO
0B22  EA0A    		dw	dIR	; 7	- TODO
0B24  ED0A    		dw	dPSWp	; 8	- TODO
0B26  F00A    		dw	dBCp	; 9	- TODO
0B28  F30A    		dw	dDEp	; 10	- TODO
0B2A  F60A    		dw	dHLp	; 11	- TODO
0B2C  F90A    		dw	dPC	; 12	- 5
001A          	nReg	equ	$-LedRegTbl	; 2x num registers...
		
0B2E  3A0520  	lra:	lda	RegI
0B31  5F      	lrax:	mov	e,a
0B32  1600    		mvi	d,0
0B34  2A1D20  		lhld	RegPtr
0B37  19      		dad	d
0B38  C9      		ret
		
0B39          	mov3dsp:
0B39  2E03    		mvi	l,3
0B3B          	movLdsp:
0B3B  0A      	md0:	ldax	b
0B3C  12      		stax	d
0B3D  03      		inx	b
0B3E  13      		inx	d
0B3F  2D      		dcr	l
0B40          		jrnz	md0
0B40  20F9    		DB	20H,md0-$-1
0B42  C9      		ret
		
0B43          	clrdisp:
0B43  210B20  		lxi	h,fpLeds
0B46  5D      		mov	e,l
0B47  54      		mov	d,h
0B48  010800  		lxi	b,9-1
0B4B  36FF    		mvi	m,11111111b
0B4D  13      		inx	d
0B4E          		ldir
0B4E  EDB0    		DB	0EDH,0B0H
0B50  C9      		ret
		
		; Front panel display refresh and keypad check
0B51          	int1$fp:
0B51  0E00    		mvi	c,0
0B53  213C20  		lxi	h,horn
0B56  7E      		mov	a,m
0B57  B7      		ora	a
0B58          		jrz	fp1
0B58  2805    		DB	28H,fp1-$-1
0B5A  35      		dcr	m
0B5B          		jrnz	fp1
0B5B  2002    		DB	20H,fp1-$-1
0B5D  0E80    		mvi	c,10000000b	; beep off
0B5F          	fp1:
0B5F  210820  		lxi	h,MFlag
0B62  46      		mov	b,m
0B63  23      		inx	h	; ctl$F0
0B64  7E      		mov	a,m
0B65  B1      		ora	c	; beep off bit
0B66  77      		mov	m,a
0B67          		bit	6,b	; refresh display?
0B67  CB70    		DB	0CBH,6*8+b+40H
0B69          		jrnz	fp3
0B69  200B    		DB	20H,fp3-$-1
0B6B  23      		inx	h	; Refind
0B6C  35      		dcr	m
0B6D          		jrnz	fp2
0B6D  2002    		DB	20H,fp2-$-1
0B6F  3609    		mvi	m,9
0B71  5E      	fp2:	mov	e,m	; 1-9
0B72  1600    		mvi	d,0
0B74  19      		dad	d	; HL = &fpLeds[E-1]
0B75  B3      		ora	e	; merge digit select
0B76          	fp3:
0B76  D3F0    		out	0f0h
0B78  7E      		mov	a,m	; FP segments (fpLeds[E-1])
0B79  D3F1    		out	0f1h
			; See if time to update display values or check keypad
0B7B  2E1B    		mvi	l,LOW ticcnt
0B7D  7E      		mov	a,m
0B7E  F5      		push	psw
0B7F  E61F    		ani	31	; 64mS
0B81  CC2C0A  		cz	ufd	; B=MFlag
0B84  F1      		pop	psw
0B85  E60F    		ani	15	; 32mS
0B87  CC0B0A  		cz	kpchk
		endif
0B8A          	int1$xx:
			; not really FP related, but no space in low ROM...
0B8A  3A0820  		lda	MFlag
0B8D  0F      		rrc		; private int1?
0B8E  DC1F20  		cc	vrst1
0B91  C34A00  		jmp	intret
		
		; match module by character (letter)
		; C=letter, B=00:cmd,ff:boot
0B94          	bfchr:	ldx	a,+2	; phy drv or type
0B94  DD7E02  		DB	0DDH,a*8+46H,+2
0B97  D6C8    		sui	200	; boot modules < 200
0B99  9F      		sbb	a	; ff=boot, 00=cmd
0B9A  B8      		cmp	b	; ZR=match
0B9B          		jrnz	bfn0
0B9B  2023    		DB	20H,bfn0-$-1
0B9D          		ldx	a,mdchr
0B9D  DD7E0A  		DB	0DDH,a*8+46H,mdchr
0BA0  B9      		cmp	c
0BA1  C9      		ret
		
		; match module by FP key
		; C=FP key, B=00:cmd,ff:boot
0BA2          	bfkey:	ldx	a,+2	; phy drv or type
0BA2  DD7E02  		DB	0DDH,a*8+46H,+2
0BA5  D6C8    		sui	200	; boot modules < 200
0BA7  9F      		sbb	a	; ff=boot, 00=cmd
0BA8  B8      		cmp	b	; ZR=match
0BA9          		jrnz	bfn0
0BA9  2015    		DB	20H,bfn0-$-1
0BAB          		ldx	a,mdkey
0BAB  DD7E0B  		DB	0DDH,a*8+46H,mdkey
0BAE  B9      		cmp	c
0BAF  C9      		ret
		
		; match boot module by phy drv number
		; C=phy drv (base), B=type
		; Only for boot modules
0BB0          	bfnum:	ldx	a,mdbase	; phy drv or type
0BB0  DD7E02  		DB	0DDH,a*8+46H,mdbase
0BB3  FEC8    		cpi	200	; boot modules < 200
0BB5          		jrnc	bfn0	; skip if >= 200
0BB5  3009    		DB	30H,bfn0-$-1
0BB7  79      		mov	a,c
0BB8          		subx	mdbase
0BB8  DD9602  		DB	0DDH,96H,mdbase
0BBB  B7      		ora	a
0BBC          		jrnz	bfn0
0BBC  2002    		DB	20H,bfn0-$-1
0BBE  AF      		xra	a
0BBF  C9      		ret
0BC0  AF      	bfn0:	xra	a
0BC1  3C      		inr	a
0BC2  C9      		ret
		
		; List only boot modules
		; On first module, C=0
0BC3          	bflst:	ldx	a,mdbase	; phy drv or type
0BC3  DD7E02  		DB	0DDH,a*8+46H,mdbase
0BC6  FEC8    		cpi	200	; boot modules < 200
0BC8          		jrnc	bfn0
0BC8  30F6    		DB	30H,bfn0-$-1
0BCA  79      		mov	a,c
0BCB  B7      		ora	a
0BCC  3E2C    		mvi	a,','
0BCE  C4C203  		cnz	conout
0BD1  0C      		inr	c
0BD2  78      		mov	a,b
0BD3          		subx	mdbase
0BD3  DD9602  		DB	0DDH,96H,mdbase
0BD6  B7      		ora	a
0BD7  3E2A    		mvi	a,'*'
0BD9  CCC203  		cz	conout
0BDC          		pushix
0BDC  DDE5    		DB	0DDH,0E5H
0BDE  E1      		pop	h
0BDF  111000  		lxi	d,mdname
0BE2  19      		dad	d
0BE3  CDBD09  		call	msgout
0BE6  21C30B  		lxi	h,bflst
0BE9          		jr	bfn0	; NZ - keep going
0BE9  18D5    		DB	18H,bfn0-$-1
		
		; List only boot modules
0BEB          	bfllst:	ldx	a,mdbase	; phy drv or type
0BEB  DD7E02  		DB	0DDH,a*8+46H,mdbase
0BEE  FEC8    		cpi	200	; boot modules < 200
0BF0          		jrnc	bfn0
0BF0  30CE    		DB	30H,bfn0-$-1
0BF2  78      		mov	a,b
0BF3          		subx	mdbase
0BF3  DD9602  		DB	0DDH,96H,mdbase
0BF6  B7      		ora	a
0BF7  3E20    		mvi	a,' '
0BF9          		jrnz	bfll2
0BF9  2002    		DB	20H,bfll2-$-1
0BFB  3E2A    		mvi	a,'*'
0BFD  CDC203  	bfll2:	call	conout
0C00          		pushix
0C00  DDE5    		DB	0DDH,0E5H
0C02  E1      		pop	h
0C03  111000  		lxi	d,mdname
0C06  19      		dad	d
0C07  CDBD09  		call	msgout
0C0A  3E09    		mvi	a,TAB
0C0C  CDC203  		call	conout
0C0F          		ldx	a,mdchr
0C0F  DD7E0A  		DB	0DDH,a*8+46H,mdchr
0C12  CDC203  		call	conout
0C15  3E20    		mvi	a,' '
0C17  CDC203  		call	conout
0C1A          		ldx	a,mdkey
0C1A  DD7E0B  		DB	0DDH,a*8+46H,mdkey
0C1D  C630    		adi	'0'
0C1F          		jrnc	bfll0
0C1F  3002    		DB	30H,bfll0-$-1
0C21  3E2D    		mvi	a,'-'
0C23  CDC203  	bfll0:	call	conout
0C26  3E20    		mvi	a,' '
0C28  CDC203  		call	conout
0C2B          		ldx	a,mdbase
0C2B  DD7E02  		DB	0DDH,a*8+46H,mdbase
0C2E  CD9F0C  		call	decout
0C31  CDB309  		call	crlf
0C34  21EB0B  		lxi	h,bfllst
0C37  AF      		xra	a	; NZ - keep going
0C38  3C      		inr	a	;
0C39  C9      		ret
		
		; Find boot module and load into 1000h if necessary.
		; HL=match function: returns Z if found, BC=target, IX=module
		; Return CY at end of modules (not found)
		; Return IX=loaded module (run location)
		; Must preserve BC during search loop.
0C3A          	bfind:
			; can't check if it's loaded until we know where it's loaded...
			; first, check if already loaded
			;lxix	btovl
			;call	icall
			;rz
0C3A          	bfind0:
0000          	if z180
		else
			; must map ROM back in, so prevent interruptions...
			; also, we loose memory at SP...
0C3A  F3      		di
0C3B          		lxiy	0
0C3B  FD21    		DB	0FDH,21H
0C3D  0000    		DW	0
0C3F          		dady	sp
0C3F  FD39    		DB	0FDH,sp*8+09H
0C41  3100E0  		lxi	sp,0e000h	; a safe SP?
0C44  3A3620  		lda	ctl$F2
0C47  F5      		push	psw
0C48  E6DF    		ani	not ctl$ORG0	; ORG0 off
0C4A  F608    		ori	ctl$MEM1	; MEM1 on
0C4C  D3F2    		out	0f2h
		endif
0C4E          		lxix	btmods	; start of modules...
0C4E  DD21    		DB	0DDH,21H
0C50  0020    		DW	btmods
0C52  CD4201  	bf0:	call	icall
0C55          		jrz	bf9
0C55  2820    		DB	28H,bf9-$-1
0C57          		ldx	d,mdpgs
0C57  DD5600  		DB	0DDH,d*8+46H,mdpgs
0C5A  1E00    		mvi	e,0
0C5C          		dadx	d
0C5C  DD19    		DB	0DDH,d*8+09H
0C5E          		pushix
0C5E  DDE5    		DB	0DDH,0E5H
0C60  F1      		pop	psw	; A=IXh
0C61  FE80    		cpi	HIGH bterom	; end of ROM
0C63          		jrnc	bf1
0C63  300A    		DB	30H,bf1-$-1
0C65          		ldx	a,mdpgs
0C65  DD7E00  		DB	0DDH,a*8+46H,mdpgs
0C68  B7      		ora	a
0C69          		jrz	bf1
0C69  2804    		DB	28H,bf1-$-1
0C6B  FEFF    		cpi	0ffh
0C6D          		jrnz	bf0
0C6D  20E3    		DB	20H,bf0-$-1
0C6F          	bf1:
0000          	if z180
		else
0C6F  F1      		pop	psw
0C70  D3F2    		out	0f2h
0C72          		spiy
0C72  FDF9    		DB	0FDH,0F9H
0C74  FB      		ei
		endif
0C75  37      		stc	; CY = end of list (not found)
0C76  C9      		ret
		
0C77          	bf9:	; match found, now load into place and init
0C77          		ldx	b,mdpgs
0C77  DD4600  		DB	0DDH,b*8+46H,mdpgs
0C7A          		ldx	d,mdorg
0C7A  DD5601  		DB	0DDH,d*8+46H,mdorg
0C7D          		pushix		;
0C7D  DDE5    		DB	0DDH,0E5H
0C7F  E1      		pop	h	; HL=IX (module in logical addr)
0C80  1E00    		mvi	e,0
0C82  0E00    		mvi	c,0
0C84  D5      		push	d
0000          	if z180
		else
			; TODO: avoid redundant load... and init?
0C85          		ldir
0C85  EDB0    		DB	0EDH,0B0H
		endif
0C87          		popix	; module load addr
0C87  DDE1    		DB	0DDH,0E1H
			; now call init routine... but must restore RAM...
0000          	if z180
		else
0C89  F1      		pop	psw
0C8A  D3F2    		out	0f2h
0C8C          		spiy
0C8C  FDF9    		DB	0FDH,0F9H
0C8E  FB      		ei
		endif
0C8F  CD930C  		call	btinit	; CY indicates error, pass along...
0C92  C9      		ret
		
		; IX=module in real memory
0C93          	btinit:	pushix
0C93  DDE5    		DB	0DDH,0E5H
0C95  E1      		pop	h
0C96  2E04    		mvi	l,mdinit
0C98  E9      		pchl
		
		; IX=module in real memory
0C99          	cmexec:
0C99          	btboot:	pushix
0C99  DDE5    		DB	0DDH,0E5H
0C9B  E1      		pop	h
0C9C  2E07    		mvi	l,mdboot
0C9E  E9      		pchl
		
		; assume < 100
0C9F          	decout:
0C9F  1630    		mvi	d,'0'
0CA1          	decot0:
0CA1  D60A    		sui	10
0CA3  DAAA0C  		jc	decot1
0CA6  14      		inr	d
0CA7  C3A10C  		jmp	decot0
0CAA          	decot1:
0CAA  C60A    		adi	10
0CAC  C630    		adi	'0'
0CAE  F5      		push	psw
0CAF  7A      		mov	a,d
0CB0  CDC203  		call	conout
0CB3  F1      		pop	psw
0CB4  C3C203  		jmp	conout
		
		; Returns NZ if found, D=phy drv
0CB7          	gtdvtb:
0CB7  DBF2    		in	0f2h
0CB9  E670    		ani	01110000b	; default boot device
0CBB  07      		rlc
0CBC  07      		rlc
0CBD  07      		rlc
0CBE  07      		rlc
0CBF  215B0D  		lxi	h,defbt
0CC2          	gtdvtb0:
0CC2  85      		add	l
0CC3  6F      		mov	l,a
0CC4  3E00    		mvi	a,0
0CC6  8C      		adc	h
0CC7  67      		mov	h,a
0CC8  56      		mov	d,m	; might be FF or FE
0CC9  C9      		ret
		
0CCA          	A$boot:
0CCA  CDF801  		call	gtdfbt	; DE=phy drv/unit
0CCD  7A      		mov	a,d
0CCE  FEFF    		cpi	0ffh
0CD0  CA1C02  		jz	s501er
0CD3  FEFE    		cpi	0feh
0CD5          		jrnz	findit
0CD5  200D    		DB	20H,findit-$-1
0CD7  2104F8  		lxi	h,susave+dpdev
0CDA  7E      		mov	a,m
0CDB  23      		inx	h
0CDC  FEFF    		cpi	0ffh
0CDE  CA1C02  		jz	s501er	; not setup
0CE1  C39202  		jmp	gotit1
0CE4          	findit:
0CE4  D5      		push	d
0CE5  C5      		push	b
0CE6  4A      		mov	c,d
0CE7  06FF    		mvi	b,-1	; boot modules only
0CE9  21B00B  		lxi	h,bfnum
0CEC  CD3A0C  		call	bfind
0CEF  C1      		pop	b
0CF0  D1      		pop	d
0CF1  DA1C02  		jc	s501er
0CF4  CDB202  		call	vfport
0CF7  DA1C02  		jc	s501er
0CFA  C3A902  		jmp	gotit
		
		; default boot selected from console
0CFD          	dfboot:
0CFD  CDF801  		call	gtdfbt	; DE=phy drv/unit
0D00  7A      		mov	a,d
0D01  FEFF    		cpi	0ffh
0D03  CABE01  		jz	error
0D06  FEFE    		cpi	0feh
0D08  C23A02  		jnz	gotnum
0D0B  2104F8  		lxi	h,susave+dpdev
0D0E  CD1B0D  		call	dfboot0
0D11  DABE01  		jc	error
0D14  B7      		ora	a
0D15  C2BE01  		jnz	error
0D18  C3F502  		jmp	goboot
		
0D1B          	dfboot0:	; HL=setup data for pri or sec
0D1B  7E      		mov	a,m
0D1C  23      		inx	h
0D1D  FEFF    		cpi	0ffh
0D1F  C8      		rz		; A <> 0: not setup
0D20  E5      		push	h
0D21  4F      		mov	c,a
0D22  06FF    		mvi	b,-1	; boot modules only
0D24  21940B  		lxi	h,bfchr
0D27  CD3A0C  		call	bfind
0D2A  E1      		pop	h
0D2B  D8      		rc		; CY: no module - error
0D2C  CDB202  		call	vfport
0D2F  D8      		rc		; CY: SW501 error
0D30          		ldx	d,mdbase
0D30  DD5602  		DB	0DDH,d*8+46H,mdbase
0D33  7E      		mov	a,m
0D34  23      		inx	h
0D35  FEFF    		cpi	0ffh
0D37          		jrnz	dfbt0
0D37  2001    		DB	20H,dfbt0-$-1
0D39  AF      		xra	a
0D3A          	dfbt0:	cmpx	mdluns
0D3A  DDBE03  		DB	0DDH,0BEH,mdluns
0D3D  3F      		cmc
0D3E  D8      		rc
0D3F  5F      		mov	e,a	; DE=phy drv base,unit
0D40  7E      		mov	a,m
0D41  FEFF    		cpi	0ffh	; no string?
0D43          		jrz	dfbt2
0D43  2814    		DB	28H,dfbt2-$-1
0D45  D5      		push	d
0D46  118122  		lxi	d,bootbf+1	; len in +0...
0D49  0E00    		mvi	c,0
0D4B  7E      	dfbt1:	mov	a,m
0D4C  12      		stax	d
0D4D  23      		inx	h
0D4E  13      		inx	d
0D4F  0C      		inr	c
0D50  B7      		ora	a
0D51          		jrnz	dfbt1
0D51  20F8    		DB	20H,dfbt1-$-1
0D53  79      		mov	a,c
0D54  3D      		dcr	a
0D55  328022  		sta	bootbf
0D58  D1      		pop	d
0D59  AF      	dfbt2:	xra	a	; A=0: ready to boot
0D5A  C9      		ret
		
0D5B          	defbt:	; default boot table... port F2 bits 01110000b
0D5B  21      		db	33	; -000---- MMS 5" floppy 0
0D5C  1D      		db	29	; -001---- MMS 8" floppy 0
0D5D  FF      		db	0ffh	; -010---- n/a  (port 7CH)
0D5E  FF      		db	0ffh	; -011---- n/a  (port 78H)
0D5F  29      		db	41	; -100---- VDIP1
0D60  46      		db	70	; -101---- GIDE disk part 0
0D61  3C      		db	60	; -110---- Network
0D62  FE      		db	0feh	; -111---- use setup primary
		
0000          	if z180
		endif
		
0000          	if z180
		else
0D63          	savram:	; interrupts are disabled
			; init mmu
0D63  3E00    		mvi	a,0	; page 0
0D65  D300    		out	rd00k
0D67  D304    		out	wr00k
0D69  3C      		inr	a
0D6A  D301    		out	rd16k
0D6C  D305    		out	wr16k
0D6E  3C      		inr	a
0D6F  D302    		out	rd32k
0D71  D306    		out	wr32k
0D73  3C      		inr	a
0D74  F680    		ori	ena
0D76  D303    		out	rd48k
0D78  D307    		out	wr48k
			; setup pages 8000->00000, c000->30000
0D7A  3E80    		mvi	a,00h+ena
0D7C  D302    		out	rd32k
0D7E  3E8C    		mvi	a,0ch+ena
0D80  D307    		out	wr48k
0D82  210080  		lxi	h,08000h
0D85  1100C0  		lxi	d,0c000h
0D88  010040  		lxi	b,16*1024
0D8B          		ldir
0D8B  EDB0    		DB	0EDH,0B0H
			; de-init mmu
0D8D  3E00    		mvi	a,0
0D8F  D300    		out	rd00k	; turn off MAP bit, back to normal
0D91  C9      		ret
		endif
		
0D92  3600    	linix:	mvi	m,0	; terminate buffer
0D94  C9      		ret
		
		; input a line from console, allow backspace
		; HL=buffer (size 128)
		; returns B=num chars, 128 max (never is 0c3h)
0D95          	linin:
0D95  0600    		mvi	b,0	; count chars
0D97  CDC609  	lini0	call	conin	; handles DEL (cancel)
0D9A  FE0D    		cpi	CR
0D9C          		jrz	linix
0D9C  28F4    		DB	28H,linix-$-1
0D9E  FE08    		cpi	BS
0DA0          		jrz	backup
0DA0  281C    		DB	28H,backup-$-1
0DA2  FE20    		cpi	' '
0DA4          		jrc	chrnak
0DA4  3811    		DB	38H,chrnak-$-1
0DA6  FE7F    		cpi	'~'+1
0DA8          		jrnc	chrnak
0DA8  300D    		DB	30H,chrnak-$-1
0DAA  77      	chrok:	mov	m,a
0DAB  23      		inx	h
0DAC  04      		inr	b
0DAD  FAB50D  		jm	chrovf	; 128 chars max
0DB0  CDC203  		call	conout
0DB3          		jr	lini0
0DB3  18E2    		DB	18H,lini0-$-1
0DB5  2B      	chrovf:	dcx	h
0DB6  05      		dcr	b
0DB7  3E07    	chrnak:	mvi	a,BEL
0DB9  CDC203  		call	conout
0DBC          		jr	lini0
0DBC  18D9    		DB	18H,lini0-$-1
0DBE          	backup:
0DBE  78      		mov	a,b
0DBF  B7      		ora	a
0DC0          		jrz	lini0
0DC0  28D5    		DB	28H,lini0-$-1
0DC2  05      		dcr	b
0DC3  2B      		dcx	h
0DC4  3E08    		mvi	a,BS
0DC6  CDC203  		call	conout
0DC9  3E20    		mvi	a,' '
0DCB  CDC203  		call	conout
0DCE  3E08    		mvi	a,BS
0DD0  CDC203  		call	conout
0DD3          		jr	lini0
0DD3  18C2    		DB	18H,lini0-$-1
		
		; Used during entry of LUN in boot command.
		; multiply E by 16, check for >= (IX+mdnum) (or overflow)
		; add in A (converted to binary).
		; IX=active boot module
		; Returns CY on overflow, else E updated to new LUN value
0DD5          	E$x16$A:
0DD5  43      		mov	b,e
0DD6          		ralr	b
0DD6  CB10    		DB	0CBH, 10H+b
0DD8  D8      		rc
0DD9          		ralr	b
0DD9  CB10    		DB	0CBH, 10H+b
0DDB  D8      		rc
0DDC          		ralr	b
0DDC  CB10    		DB	0CBH, 10H+b
0DDE  D8      		rc
0DDF          		ralr	b
0DDF  CB10    		DB	0CBH, 10H+b
0DE1  D8      		rc
0DE2  F5      		push	psw
0DE3  D630    		sui	'0'
0DE5  FE0A    		cpi	9+1
0DE7          		jrc	ex16a0
0DE7  3802    		DB	38H,ex16a0-$-1
0DE9  D607    		sui	'A'-'0'-10
0DEB  80      	ex16a0:	add	b	; never CY
0DEC          		cmpx	mdluns	; might be 0ffh
0DEC  DDBE03  		DB	0DDH,0BEH,mdluns
0DEF          		jrc	ex16a1	; value OK
0DEF  3803    		DB	38H,ex16a1-$-1
0DF1  F1      		pop	psw
0DF2  37      		stc
0DF3  C9      		ret
0DF4  5F      	ex16a1:	mov	e,a
0DF5  F1      		pop	psw
0DF6  C9      		ret
		
		;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
		; Dump command
0DF7          	cmddmp:
0DF7  21D506  		lxi	h,dmpms
0DFA  CDBD09  		call	msgout
0DFD  211420  		lxi	h,ABUSS
0E00  B7      		ora	a	; NC
0E01  160D    		mvi	d,CR
0E03  CDCD03  		call	adrin
0E06  EB      		xchg	; HL=adr
0E07  0608    		mvi	b,8	; 8 lines (one half page, 128 bytes)
0E09  C5      	dmp0:	push	b
0E0A  CD2004  		call	adrnl	; CR,LF,"AAAA " (HL=AAAA)
0E0D  E5      		push	h
0E0E  0610    		mvi	b,16
0E10  7E      	dmp1:	mov	a,m
0E11  CD2F04  		call	hexout
0E14  CD2B04  		call	spout
0E17  23      		inx	h
0E18          		djnz	dmp1
0E18  10F6    		DB	10H,dmp1-$-1
0E1A  E1      		pop	h
0E1B  0610    		mvi	b,16
0E1D  7E      	dmp2:	mov	a,m
0E1E  FE20    		cpi	' '
0E20          		jrc	dmp3
0E20  3804    		DB	38H,dmp3-$-1
0E22  FE7F    		cpi	'~'+1
0E24          		jrc	dmp4
0E24  3802    		DB	38H,dmp4-$-1
0E26  3E2E    	dmp3:	mvi	a,'.'
0E28  CDC203  	dmp4:	call	conout
0E2B  23      		inx	h
0E2C          		djnz	dmp2
0E2C  10EF    		DB	10H,dmp2-$-1
0E2E  C1      		pop	b
0E2F          		djnz	dmp0
0E2F  10D8    		DB	10H,dmp0-$-1
0E31  221420  		shld	ABUSS
0E34  C9      		ret
		
		;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
		; List available boot modules
0E35  21480E  	cmdlb:	lxi	h,lbmsg
0E38  CDBD09  		call	msgout
0E3B  CDF801  		call	gtdfbt
0E3E  42      		mov	b,d
0E3F  21C30B  		lxi	h,bflst
0E42  0E00    		mvi	c,0
0E44  CD3A0C  		call	bfind0
0E47  C9      		ret
		
0E48  69737420	lbmsg:	db	'ist boot modules',CR,LF,0
      626F6F74
      206D6F64
      756C6573
      0D0A00
0E5B  656C7020	hbmsg:	db	'elp boot',CR,LF,0
      626F6F74
      0D0A00
0E66  5072693A	hbmsg2:	db	'Pri: ',0
      2000
FFFF          	if not nofp
0E6C  5365633A	hbmsg3:	db	'Sec: ',0
      2000
		endif
		
		; Help boot command
0E72  215B0E  	cmdhb:	lxi	h,hbmsg
0E75  CDBD09  		call	msgout
0E78  CDF801  		call	gtdfbt
0E7B  42      		mov	b,d
0E7C  21EB0B  		lxi	h,bfllst
0E7F  CD3A0C  		call	bfind0
			; Now display primary/secondary configs
0E82  21660E  		lxi	h,hbmsg2
0E85  1104F8  		lxi	d,susave+dpdev
0E88  DBF2    		in	0f2h
0E8A  E670    		ani	01110000b	; default boot device
0E8C  FE70    		cpi	01110000b	; use setup cfg?
0E8E  3E2A    		mvi	a,'*'
0E90          		jrz	cmdhb6
0E90  2802    		DB	28H,cmdhb6-$-1
0E92  3E20    		mvi	a,' '
0E94  CDA30E  	cmdhb6:	call	cmdhbx
FFFF          	if not nofp
0E97  216C0E  		lxi	h,hbmsg3
0E9A  1186F8  		lxi	d,susave+dsdev
0E9D  3E20    		mvi	a,' '	; never the default
0E9F  CDA30E  		call	cmdhbx
		endif
0EA2  C9      		ret
		
0EA3  CDC203  	cmdhbx:	call	conout
0EA6  CDBD09  		call	msgout
0EA9  1A      		ldax	d
0EAA  13      		inx	d
0EAB  FEFF    		cpi	0ffh
0EAD          		jrnz	cmdhb0
0EAD  2002    		DB	20H,cmdhb0-$-1
0EAF  3E2D    		mvi	a,'-'
0EB1  CDC203  	cmdhb0:	call	conout
0EB4  3E20    		mvi	a,' '
0EB6  CDC203  		call	conout
0EB9  1A      		ldax	d
0EBA  13      		inx	d
0EBB  C630    		adi	'0'	; FF=2F,CY
0EBD          		jrnc	cmdhb1
0EBD  3002    		DB	30H,cmdhb1-$-1
0EBF  3E2D    		mvi	a,'-'
0EC1  CDC203  	cmdhb1:	call	conout
0EC4  3E20    		mvi	a,' '
0EC6  CDC203  		call	conout
0EC9  1A      		ldax	d
0ECA  FEFF    		cpi	0ffh
0ECC          		jrnz	cmdhb2
0ECC  2007    		DB	20H,cmdhb2-$-1
0ECE  3E2D    		mvi	a,'-'
0ED0  CDC203  		call	conout
0ED3          		jr	cmdhb3
0ED3  1804    		DB	18H,cmdhb3-$-1
0ED5  EB      	cmdhb2:	xchg
0ED6  CDBD09  		call	msgout
0ED9  CDB309  	cmdhb3:	call	crlf
0EDC  C9      		ret
		;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
		
		;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
		; Add new boot module
0EDD  C9      	cmdab:	ret
		;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
		
		;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
		; Update ROM
0EDE  C9      	cmdur:	ret
		;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
		
		;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
		; Terminal mode - shuttle I/O between H19 and serial port
		; since both ports operate at the same speed, don't need
		; to check ready as often.
0EDF          	termod:
0EDF  21270F  		lxi	h,terms
0EE2  CDBD09  		call	msgout
0EE5  CDAC09  		call	waitcr
0EE8          	termfl:
0EE8  DBED    		in	0edh
0EEA  E660    		ani	01100000b
0EEC  FE60    		cpi	01100000b
0EEE          		jrnz	termfl	; wait for output to flush
0EEE  20F8    		DB	20H,termfl-$-1
0EF0  DBEB    		in	0ebh
0EF2  F680    		ori	10000000b
0EF4  D3EB    		out	0ebh
0EF6  D3DB    		out	0dbh
0EF8  DBE8    		in	0e8h
0EFA  D3D8    		out	0d8h
0EFC  DBE9    		in	0e9h
0EFE  D3D9    		out	0d9h
0F00  DBEB    		in	0ebh
0F02  E67F    		ani	01111111b
0F04  D3EB    		out	0ebh
0F06  D3DB    		out	0dbh
0F08  AF      		xra	a
0F09  D3D9    		out	0d9h
0F0B  DBD8    		in	0d8h
0F0D  3E0F    		mvi	a,00fh
0F0F  D3DC    		out	0dch
0F11          	termlp:
0F11  DBDD    		in	0ddh
0F13  E601    		ani	00000001b
0F15          		jrz	terml0
0F15  2804    		DB	28H,terml0-$-1
0F17  DBD8    		in	0d8h
0F19  D3E8    		out	0e8h
0F1B          	terml0:
0F1B  DBED    		in	0edh
0F1D  E601    		ani	00000001b
0F1F          		jrz	termlp
0F1F  28F0    		DB	28H,termlp-$-1
0F21  DBE8    		in	0e8h
0F23  D3D8    		out	0d8h
0F25          		jr	termlp
0F25  18EA    		DB	18H,termlp-$-1
		
0F27  65726D69	terms:	db	'erminal Mode',TRM
      6E616C20
      4D6F6465
      00
		;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
		
		;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
		; Print ROM version command
0F34          	prtver:
0F34  21410F  		lxi	h,versms
0F37  CDBD09  		call	msgout
0F3A  21570F  		lxi	h,vernum
0F3D  CDBD09  		call	msgout
0F40  C9      		ret
		
0F41  65727369	versms:	db	'ersion ',TRM
      6F6E2000
		;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0F49  0D0A4838	signon:	db	CR,LF,'H8'
0000          	if h8nofp
		endif
0000          	if h89
		endif
0F4D  20      		db	' '
0000          	if z180
		endif
0F4E  4D6F6E69		db	'Monitor v'
      746F7220
      76
0F57  322E30  	vernum:	db	(VERN SHR 4)+'0','.',(VERN AND 0fh)+'0'
0000          	if alpha
		endif
0006          	if beta
0F5A  28626574		db	'(beta',beta+'0',')'
      613629
		endif
0F61  0D0A00  		db	CR,LF,TRM
		
			rept	1000h-$-2
0F64  FF      		db	0ffh
0F65  FF      		db	0ffh
0F66  FF      		db	0ffh
0F67  FF      		db	0ffh
0F68  FF      		db	0ffh
0F69  FF      		db	0ffh
0F6A  FF      		db	0ffh
0F6B  FF      		db	0ffh
0F6C  FF      		db	0ffh
0F6D  FF      		db	0ffh
0F6E  FF      		db	0ffh
0F6F  FF      		db	0ffh
0F70  FF      		db	0ffh
0F71  FF      		db	0ffh
0F72  FF      		db	0ffh
0F73  FF      		db	0ffh
0F74  FF      		db	0ffh
0F75  FF      		db	0ffh
0F76  FF      		db	0ffh
0F77  FF      		db	0ffh
0F78  FF      		db	0ffh
0F79  FF      		db	0ffh
0F7A  FF      		db	0ffh
0F7B  FF      		db	0ffh
0F7C  FF      		db	0ffh
0F7D  FF      		db	0ffh
0F7E  FF      		db	0ffh
0F7F  FF      		db	0ffh
0F80  FF      		db	0ffh
0F81  FF      		db	0ffh
0F82  FF      		db	0ffh
0F83  FF      		db	0ffh
0F84  FF      		db	0ffh
0F85  FF      		db	0ffh
0F86  FF      		db	0ffh
0F87  FF      		db	0ffh
0F88  FF      		db	0ffh
0F89  FF      		db	0ffh
0F8A  FF      		db	0ffh
0F8B  FF      		db	0ffh
0F8C  FF      		db	0ffh
0F8D  FF      		db	0ffh
0F8E  FF      		db	0ffh
0F8F  FF      		db	0ffh
0F90  FF      		db	0ffh
0F91  FF      		db	0ffh
0F92  FF      		db	0ffh
0F93  FF      		db	0ffh
0F94  FF      		db	0ffh
0F95  FF      		db	0ffh
0F96  FF      		db	0ffh
0F97  FF      		db	0ffh
0F98  FF      		db	0ffh
0F99  FF      		db	0ffh
0F9A  FF      		db	0ffh
0F9B  FF      		db	0ffh
0F9C  FF      		db	0ffh
0F9D  FF      		db	0ffh
0F9E  FF      		db	0ffh
0F9F  FF      		db	0ffh
0FA0  FF      		db	0ffh
0FA1  FF      		db	0ffh
0FA2  FF      		db	0ffh
0FA3  FF      		db	0ffh
0FA4  FF      		db	0ffh
0FA5  FF      		db	0ffh
0FA6  FF      		db	0ffh
0FA7  FF      		db	0ffh
0FA8  FF      		db	0ffh
0FA9  FF      		db	0ffh
0FAA  FF      		db	0ffh
0FAB  FF      		db	0ffh
0FAC  FF      		db	0ffh
0FAD  FF      		db	0ffh
0FAE  FF      		db	0ffh
0FAF  FF      		db	0ffh
0FB0  FF      		db	0ffh
0FB1  FF      		db	0ffh
0FB2  FF      		db	0ffh
0FB3  FF      		db	0ffh
0FB4  FF      		db	0ffh
0FB5  FF      		db	0ffh
0FB6  FF      		db	0ffh
0FB7  FF      		db	0ffh
0FB8  FF      		db	0ffh
0FB9  FF      		db	0ffh
0FBA  FF      		db	0ffh
0FBB  FF      		db	0ffh
0FBC  FF      		db	0ffh
0FBD  FF      		db	0ffh
0FBE  FF      		db	0ffh
0FBF  FF      		db	0ffh
0FC0  FF      		db	0ffh
0FC1  FF      		db	0ffh
0FC2  FF      		db	0ffh
0FC3  FF      		db	0ffh
0FC4  FF      		db	0ffh
0FC5  FF      		db	0ffh
0FC6  FF      		db	0ffh
0FC7  FF      		db	0ffh
0FC8  FF      		db	0ffh
0FC9  FF      		db	0ffh
0FCA  FF      		db	0ffh
0FCB  FF      		db	0ffh
0FCC  FF      		db	0ffh
0FCD  FF      		db	0ffh
0FCE  FF      		db	0ffh
0FCF  FF      		db	0ffh
0FD0  FF      		db	0ffh
0FD1  FF      		db	0ffh
0FD2  FF      		db	0ffh
0FD3  FF      		db	0ffh
0FD4  FF      		db	0ffh
0FD5  FF      		db	0ffh
0FD6  FF      		db	0ffh
0FD7  FF      		db	0ffh
0FD8  FF      		db	0ffh
0FD9  FF      		db	0ffh
0FDA  FF      		db	0ffh
0FDB  FF      		db	0ffh
0FDC  FF      		db	0ffh
0FDD  FF      		db	0ffh
0FDE  FF      		db	0ffh
0FDF  FF      		db	0ffh
0FE0  FF      		db	0ffh
0FE1  FF      		db	0ffh
0FE2  FF      		db	0ffh
0FE3  FF      		db	0ffh
0FE4  FF      		db	0ffh
0FE5  FF      		db	0ffh
0FE6  FF      		db	0ffh
0FE7  FF      		db	0ffh
0FE8  FF      		db	0ffh
0FE9  FF      		db	0ffh
0FEA  FF      		db	0ffh
0FEB  FF      		db	0ffh
0FEC  FF      		db	0ffh
0FED  FF      		db	0ffh
0FEE  FF      		db	0ffh
0FEF  FF      		db	0ffh
0FF0  FF      		db	0ffh
0FF1  FF      		db	0ffh
0FF2  FF      		db	0ffh
0FF3  FF      		db	0ffh
0FF4  FF      		db	0ffh
0FF5  FF      		db	0ffh
0FF6  FF      		db	0ffh
0FF7  FF      		db	0ffh
0FF8  FF      		db	0ffh
0FF9  FF      		db	0ffh
0FFA  FF      		db	0ffh
0FFB  FF      		db	0ffh
0FFC  FF      		db	0ffh
0FFD  FF      		db	0ffh
0FFE  80FF    		dw	pcode	; product code for system
0000          	if	($ <> 1000h)
		endif
		
		; module overlay area starts here...
		; ensure this does not match any...
1000  FFFF    		dw	-1
1002  0000    		db	0,0
		
			rept	1800h-$
1004  FF      		db	0ffh
1005  FF      		db	0ffh
1006  FF      		db	0ffh
1007  FF      		db	0ffh
1008  FF      		db	0ffh
1009  FF      		db	0ffh
100A  FF      		db	0ffh
100B  FF      		db	0ffh
100C  FF      		db	0ffh
100D  FF      		db	0ffh
100E  FF      		db	0ffh
100F  FF      		db	0ffh
1010  FF      		db	0ffh
1011  FF      		db	0ffh
1012  FF      		db	0ffh
1013  FF      		db	0ffh
1014  FF      		db	0ffh
1015  FF      		db	0ffh
1016  FF      		db	0ffh
1017  FF      		db	0ffh
1018  FF      		db	0ffh
1019  FF      		db	0ffh
101A  FF      		db	0ffh
101B  FF      		db	0ffh
101C  FF      		db	0ffh
101D  FF      		db	0ffh
101E  FF      		db	0ffh
101F  FF      		db	0ffh
1020  FF      		db	0ffh
1021  FF      		db	0ffh
1022  FF      		db	0ffh
1023  FF      		db	0ffh
1024  FF      		db	0ffh
1025  FF      		db	0ffh
1026  FF      		db	0ffh
1027  FF      		db	0ffh
1028  FF      		db	0ffh
1029  FF      		db	0ffh
102A  FF      		db	0ffh
102B  FF      		db	0ffh
102C  FF      		db	0ffh
102D  FF      		db	0ffh
102E  FF      		db	0ffh
102F  FF      		db	0ffh
1030  FF      		db	0ffh
1031  FF      		db	0ffh
1032  FF      		db	0ffh
1033  FF      		db	0ffh
1034  FF      		db	0ffh
1035  FF      		db	0ffh
1036  FF      		db	0ffh
1037  FF      		db	0ffh
1038  FF      		db	0ffh
1039  FF      		db	0ffh
103A  FF      		db	0ffh
103B  FF      		db	0ffh
103C  FF      		db	0ffh
103D  FF      		db	0ffh
103E  FF      		db	0ffh
103F  FF      		db	0ffh
1040  FF      		db	0ffh
1041  FF      		db	0ffh
1042  FF      		db	0ffh
1043  FF      		db	0ffh
1044  FF      		db	0ffh
1045  FF      		db	0ffh
1046  FF      		db	0ffh
1047  FF      		db	0ffh
1048  FF      		db	0ffh
1049  FF      		db	0ffh
104A  FF      		db	0ffh
104B  FF      		db	0ffh
104C  FF      		db	0ffh
104D  FF      		db	0ffh
104E  FF      		db	0ffh
104F  FF      		db	0ffh
1050  FF      		db	0ffh
1051  FF      		db	0ffh
1052  FF      		db	0ffh
1053  FF      		db	0ffh
1054  FF      		db	0ffh
1055  FF      		db	0ffh
1056  FF      		db	0ffh
1057  FF      		db	0ffh
1058  FF      		db	0ffh
1059  FF      		db	0ffh
105A  FF      		db	0ffh
105B  FF      		db	0ffh
105C  FF      		db	0ffh
105D  FF      		db	0ffh
105E  FF      		db	0ffh
105F  FF      		db	0ffh
1060  FF      		db	0ffh
1061  FF      		db	0ffh
1062  FF      		db	0ffh
1063  FF      		db	0ffh
1064  FF      		db	0ffh
1065  FF      		db	0ffh
1066  FF      		db	0ffh
1067  FF      		db	0ffh
1068  FF      		db	0ffh
1069  FF      		db	0ffh
106A  FF      		db	0ffh
106B  FF      		db	0ffh
106C  FF      		db	0ffh
106D  FF      		db	0ffh
106E  FF      		db	0ffh
106F  FF      		db	0ffh
1070  FF      		db	0ffh
1071  FF      		db	0ffh
1072  FF      		db	0ffh
1073  FF      		db	0ffh
1074  FF      		db	0ffh
1075  FF      		db	0ffh
1076  FF      		db	0ffh
1077  FF      		db	0ffh
1078  FF      		db	0ffh
1079  FF      		db	0ffh
107A  FF      		db	0ffh
107B  FF      		db	0ffh
107C  FF      		db	0ffh
107D  FF      		db	0ffh
107E  FF      		db	0ffh
107F  FF      		db	0ffh
1080  FF      		db	0ffh
1081  FF      		db	0ffh
1082  FF      		db	0ffh
1083  FF      		db	0ffh
1084  FF      		db	0ffh
1085  FF      		db	0ffh
1086  FF      		db	0ffh
1087  FF      		db	0ffh
1088  FF      		db	0ffh
1089  FF      		db	0ffh
108A  FF      		db	0ffh
108B  FF      		db	0ffh
108C  FF      		db	0ffh
108D  FF      		db	0ffh
108E  FF      		db	0ffh
108F  FF      		db	0ffh
1090  FF      		db	0ffh
1091  FF      		db	0ffh
1092  FF      		db	0ffh
1093  FF      		db	0ffh
1094  FF      		db	0ffh
1095  FF      		db	0ffh
1096  FF      		db	0ffh
1097  FF      		db	0ffh
1098  FF      		db	0ffh
1099  FF      		db	0ffh
109A  FF      		db	0ffh
109B  FF      		db	0ffh
109C  FF      		db	0ffh
109D  FF      		db	0ffh
109E  FF      		db	0ffh
109F  FF      		db	0ffh
10A0  FF      		db	0ffh
10A1  FF      		db	0ffh
10A2  FF      		db	0ffh
10A3  FF      		db	0ffh
10A4  FF      		db	0ffh
10A5  FF      		db	0ffh
10A6  FF      		db	0ffh
10A7  FF      		db	0ffh
10A8  FF      		db	0ffh
10A9  FF      		db	0ffh
10AA  FF      		db	0ffh
10AB  FF      		db	0ffh
10AC  FF      		db	0ffh
10AD  FF      		db	0ffh
10AE  FF      		db	0ffh
10AF  FF      		db	0ffh
10B0  FF      		db	0ffh
10B1  FF      		db	0ffh
10B2  FF      		db	0ffh
10B3  FF      		db	0ffh
10B4  FF      		db	0ffh
10B5  FF      		db	0ffh
10B6  FF      		db	0ffh
10B7  FF      		db	0ffh
10B8  FF      		db	0ffh
10B9  FF      		db	0ffh
10BA  FF      		db	0ffh
10BB  FF      		db	0ffh
10BC  FF      		db	0ffh
10BD  FF      		db	0ffh
10BE  FF      		db	0ffh
10BF  FF      		db	0ffh
10C0  FF      		db	0ffh
10C1  FF      		db	0ffh
10C2  FF      		db	0ffh
10C3  FF      		db	0ffh
10C4  FF      		db	0ffh
10C5  FF      		db	0ffh
10C6  FF      		db	0ffh
10C7  FF      		db	0ffh
10C8  FF      		db	0ffh
10C9  FF      		db	0ffh
10CA  FF      		db	0ffh
10CB  FF      		db	0ffh
10CC  FF      		db	0ffh
10CD  FF      		db	0ffh
10CE  FF      		db	0ffh
10CF  FF      		db	0ffh
10D0  FF      		db	0ffh
10D1  FF      		db	0ffh
10D2  FF      		db	0ffh
10D3  FF      		db	0ffh
10D4  FF      		db	0ffh
10D5  FF      		db	0ffh
10D6  FF      		db	0ffh
10D7  FF      		db	0ffh
10D8  FF      		db	0ffh
10D9  FF      		db	0ffh
10DA  FF      		db	0ffh
10DB  FF      		db	0ffh
10DC  FF      		db	0ffh
10DD  FF      		db	0ffh
10DE  FF      		db	0ffh
10DF  FF      		db	0ffh
10E0  FF      		db	0ffh
10E1  FF      		db	0ffh
10E2  FF      		db	0ffh
10E3  FF      		db	0ffh
10E4  FF      		db	0ffh
10E5  FF      		db	0ffh
10E6  FF      		db	0ffh
10E7  FF      		db	0ffh
10E8  FF      		db	0ffh
10E9  FF      		db	0ffh
10EA  FF      		db	0ffh
10EB  FF      		db	0ffh
10EC  FF      		db	0ffh
10ED  FF      		db	0ffh
10EE  FF      		db	0ffh
10EF  FF      		db	0ffh
10F0  FF      		db	0ffh
10F1  FF      		db	0ffh
10F2  FF      		db	0ffh
10F3  FF      		db	0ffh
10F4  FF      		db	0ffh
10F5  FF      		db	0ffh
10F6  FF      		db	0ffh
10F7  FF      		db	0ffh
10F8  FF      		db	0ffh
10F9  FF      		db	0ffh
10FA  FF      		db	0ffh
10FB  FF      		db	0ffh
10FC  FF      		db	0ffh
10FD  FF      		db	0ffh
10FE  FF      		db	0ffh
10FF  FF      		db	0ffh
1100  FF      		db	0ffh
1101  FF      		db	0ffh
1102  FF      		db	0ffh
1103  FF      		db	0ffh
1104  FF      		db	0ffh
1105  FF      		db	0ffh
1106  FF      		db	0ffh
1107  FF      		db	0ffh
1108  FF      		db	0ffh
1109  FF      		db	0ffh
110A  FF      		db	0ffh
110B  FF      		db	0ffh
110C  FF      		db	0ffh
110D  FF      		db	0ffh
110E  FF      		db	0ffh
110F  FF      		db	0ffh
1110  FF      		db	0ffh
1111  FF      		db	0ffh
1112  FF      		db	0ffh
1113  FF      		db	0ffh
1114  FF      		db	0ffh
1115  FF      		db	0ffh
1116  FF      		db	0ffh
1117  FF      		db	0ffh
1118  FF      		db	0ffh
1119  FF      		db	0ffh
111A  FF      		db	0ffh
111B  FF      		db	0ffh
111C  FF      		db	0ffh
111D  FF      		db	0ffh
111E  FF      		db	0ffh
111F  FF      		db	0ffh
1120  FF      		db	0ffh
1121  FF      		db	0ffh
1122  FF      		db	0ffh
1123  FF      		db	0ffh
1124  FF      		db	0ffh
1125  FF      		db	0ffh
1126  FF      		db	0ffh
1127  FF      		db	0ffh
1128  FF      		db	0ffh
1129  FF      		db	0ffh
112A  FF      		db	0ffh
112B  FF      		db	0ffh
112C  FF      		db	0ffh
112D  FF      		db	0ffh
112E  FF      		db	0ffh
112F  FF      		db	0ffh
1130  FF      		db	0ffh
1131  FF      		db	0ffh
1132  FF      		db	0ffh
1133  FF      		db	0ffh
1134  FF      		db	0ffh
1135  FF      		db	0ffh
1136  FF      		db	0ffh
1137  FF      		db	0ffh
1138  FF      		db	0ffh
1139  FF      		db	0ffh
113A  FF      		db	0ffh
113B  FF      		db	0ffh
113C  FF      		db	0ffh
113D  FF      		db	0ffh
113E  FF      		db	0ffh
113F  FF      		db	0ffh
1140  FF      		db	0ffh
1141  FF      		db	0ffh
1142  FF      		db	0ffh
1143  FF      		db	0ffh
1144  FF      		db	0ffh
1145  FF      		db	0ffh
1146  FF      		db	0ffh
1147  FF      		db	0ffh
1148  FF      		db	0ffh
1149  FF      		db	0ffh
114A  FF      		db	0ffh
114B  FF      		db	0ffh
114C  FF      		db	0ffh
114D  FF      		db	0ffh
114E  FF      		db	0ffh
114F  FF      		db	0ffh
1150  FF      		db	0ffh
1151  FF      		db	0ffh
1152  FF      		db	0ffh
1153  FF      		db	0ffh
1154  FF      		db	0ffh
1155  FF      		db	0ffh
1156  FF      		db	0ffh
1157  FF      		db	0ffh
1158  FF      		db	0ffh
1159  FF      		db	0ffh
115A  FF      		db	0ffh
115B  FF      		db	0ffh
115C  FF      		db	0ffh
115D  FF      		db	0ffh
115E  FF      		db	0ffh
115F  FF      		db	0ffh
1160  FF      		db	0ffh
1161  FF      		db	0ffh
1162  FF      		db	0ffh
1163  FF      		db	0ffh
1164  FF      		db	0ffh
1165  FF      		db	0ffh
1166  FF      		db	0ffh
1167  FF      		db	0ffh
1168  FF      		db	0ffh
1169  FF      		db	0ffh
116A  FF      		db	0ffh
116B  FF      		db	0ffh
116C  FF      		db	0ffh
116D  FF      		db	0ffh
116E  FF      		db	0ffh
116F  FF      		db	0ffh
1170  FF      		db	0ffh
1171  FF      		db	0ffh
1172  FF      		db	0ffh
1173  FF      		db	0ffh
1174  FF      		db	0ffh
1175  FF      		db	0ffh
1176  FF      		db	0ffh
1177  FF      		db	0ffh
1178  FF      		db	0ffh
1179  FF      		db	0ffh
117A  FF      		db	0ffh
117B  FF      		db	0ffh
117C  FF      		db	0ffh
117D  FF      		db	0ffh
117E  FF      		db	0ffh
117F  FF      		db	0ffh
1180  FF      		db	0ffh
1181  FF      		db	0ffh
1182  FF      		db	0ffh
1183  FF      		db	0ffh
1184  FF      		db	0ffh
1185  FF      		db	0ffh
1186  FF      		db	0ffh
1187  FF      		db	0ffh
1188  FF      		db	0ffh
1189  FF      		db	0ffh
118A  FF      		db	0ffh
118B  FF      		db	0ffh
118C  FF      		db	0ffh
118D  FF      		db	0ffh
118E  FF      		db	0ffh
118F  FF      		db	0ffh
1190  FF      		db	0ffh
1191  FF      		db	0ffh
1192  FF      		db	0ffh
1193  FF      		db	0ffh
1194  FF      		db	0ffh
1195  FF      		db	0ffh
1196  FF      		db	0ffh
1197  FF      		db	0ffh
1198  FF      		db	0ffh
1199  FF      		db	0ffh
119A  FF      		db	0ffh
119B  FF      		db	0ffh
119C  FF      		db	0ffh
119D  FF      		db	0ffh
119E  FF      		db	0ffh
119F  FF      		db	0ffh
11A0  FF      		db	0ffh
11A1  FF      		db	0ffh
11A2  FF      		db	0ffh
11A3  FF      		db	0ffh
11A4  FF      		db	0ffh
11A5  FF      		db	0ffh
11A6  FF      		db	0ffh
11A7  FF      		db	0ffh
11A8  FF      		db	0ffh
11A9  FF      		db	0ffh
11AA  FF      		db	0ffh
11AB  FF      		db	0ffh
11AC  FF      		db	0ffh
11AD  FF      		db	0ffh
11AE  FF      		db	0ffh
11AF  FF      		db	0ffh
11B0  FF      		db	0ffh
11B1  FF      		db	0ffh
11B2  FF      		db	0ffh
11B3  FF      		db	0ffh
11B4  FF      		db	0ffh
11B5  FF      		db	0ffh
11B6  FF      		db	0ffh
11B7  FF      		db	0ffh
11B8  FF      		db	0ffh
11B9  FF      		db	0ffh
11BA  FF      		db	0ffh
11BB  FF      		db	0ffh
11BC  FF      		db	0ffh
11BD  FF      		db	0ffh
11BE  FF      		db	0ffh
11BF  FF      		db	0ffh
11C0  FF      		db	0ffh
11C1  FF      		db	0ffh
11C2  FF      		db	0ffh
11C3  FF      		db	0ffh
11C4  FF      		db	0ffh
11C5  FF      		db	0ffh
11C6  FF      		db	0ffh
11C7  FF      		db	0ffh
11C8  FF      		db	0ffh
11C9  FF      		db	0ffh
11CA  FF      		db	0ffh
11CB  FF      		db	0ffh
11CC  FF      		db	0ffh
11CD  FF      		db	0ffh
11CE  FF      		db	0ffh
11CF  FF      		db	0ffh
11D0  FF      		db	0ffh
11D1  FF      		db	0ffh
11D2  FF      		db	0ffh
11D3  FF      		db	0ffh
11D4  FF      		db	0ffh
11D5  FF      		db	0ffh
11D6  FF      		db	0ffh
11D7  FF      		db	0ffh
11D8  FF      		db	0ffh
11D9  FF      		db	0ffh
11DA  FF      		db	0ffh
11DB  FF      		db	0ffh
11DC  FF      		db	0ffh
11DD  FF      		db	0ffh
11DE  FF      		db	0ffh
11DF  FF      		db	0ffh
11E0  FF      		db	0ffh
11E1  FF      		db	0ffh
11E2  FF      		db	0ffh
11E3  FF      		db	0ffh
11E4  FF      		db	0ffh
11E5  FF      		db	0ffh
11E6  FF      		db	0ffh
11E7  FF      		db	0ffh
11E8  FF      		db	0ffh
11E9  FF      		db	0ffh
11EA  FF      		db	0ffh
11EB  FF      		db	0ffh
11EC  FF      		db	0ffh
11ED  FF      		db	0ffh
11EE  FF      		db	0ffh
11EF  FF      		db	0ffh
11F0  FF      		db	0ffh
11F1  FF      		db	0ffh
11F2  FF      		db	0ffh
11F3  FF      		db	0ffh
11F4  FF      		db	0ffh
11F5  FF      		db	0ffh
11F6  FF      		db	0ffh
11F7  FF      		db	0ffh
11F8  FF      		db	0ffh
11F9  FF      		db	0ffh
11FA  FF      		db	0ffh
11FB  FF      		db	0ffh
11FC  FF      		db	0ffh
11FD  FF      		db	0ffh
11FE  FF      		db	0ffh
11FF  FF      		db	0ffh
1200  FF      		db	0ffh
1201  FF      		db	0ffh
1202  FF      		db	0ffh
1203  FF      		db	0ffh
1204  FF      		db	0ffh
1205  FF      		db	0ffh
1206  FF      		db	0ffh
1207  FF      		db	0ffh
1208  FF      		db	0ffh
1209  FF      		db	0ffh
120A  FF      		db	0ffh
120B  FF      		db	0ffh
120C  FF      		db	0ffh
120D  FF      		db	0ffh
120E  FF      		db	0ffh
120F  FF      		db	0ffh
1210  FF      		db	0ffh
1211  FF      		db	0ffh
1212  FF      		db	0ffh
1213  FF      		db	0ffh
1214  FF      		db	0ffh
1215  FF      		db	0ffh
1216  FF      		db	0ffh
1217  FF      		db	0ffh
1218  FF      		db	0ffh
1219  FF      		db	0ffh
121A  FF      		db	0ffh
121B  FF      		db	0ffh
121C  FF      		db	0ffh
121D  FF      		db	0ffh
121E  FF      		db	0ffh
121F  FF      		db	0ffh
1220  FF      		db	0ffh
1221  FF      		db	0ffh
1222  FF      		db	0ffh
1223  FF      		db	0ffh
1224  FF      		db	0ffh
1225  FF      		db	0ffh
1226  FF      		db	0ffh
1227  FF      		db	0ffh
1228  FF      		db	0ffh
1229  FF      		db	0ffh
122A  FF      		db	0ffh
122B  FF      		db	0ffh
122C  FF      		db	0ffh
122D  FF      		db	0ffh
122E  FF      		db	0ffh
122F  FF      		db	0ffh
1230  FF      		db	0ffh
1231  FF      		db	0ffh
1232  FF      		db	0ffh
1233  FF      		db	0ffh
1234  FF      		db	0ffh
1235  FF      		db	0ffh
1236  FF      		db	0ffh
1237  FF      		db	0ffh
1238  FF      		db	0ffh
1239  FF      		db	0ffh
123A  FF      		db	0ffh
123B  FF      		db	0ffh
123C  FF      		db	0ffh
123D  FF      		db	0ffh
123E  FF      		db	0ffh
123F  FF      		db	0ffh
1240  FF      		db	0ffh
1241  FF      		db	0ffh
1242  FF      		db	0ffh
1243  FF      		db	0ffh
1244  FF      		db	0ffh
1245  FF      		db	0ffh
1246  FF      		db	0ffh
1247  FF      		db	0ffh
1248  FF      		db	0ffh
1249  FF      		db	0ffh
124A  FF      		db	0ffh
124B  FF      		db	0ffh
124C  FF      		db	0ffh
124D  FF      		db	0ffh
124E  FF      		db	0ffh
124F  FF      		db	0ffh
1250  FF      		db	0ffh
1251  FF      		db	0ffh
1252  FF      		db	0ffh
1253  FF      		db	0ffh
1254  FF      		db	0ffh
1255  FF      		db	0ffh
1256  FF      		db	0ffh
1257  FF      		db	0ffh
1258  FF      		db	0ffh
1259  FF      		db	0ffh
125A  FF      		db	0ffh
125B  FF      		db	0ffh
125C  FF      		db	0ffh
125D  FF      		db	0ffh
125E  FF      		db	0ffh
125F  FF      		db	0ffh
1260  FF      		db	0ffh
1261  FF      		db	0ffh
1262  FF      		db	0ffh
1263  FF      		db	0ffh
1264  FF      		db	0ffh
1265  FF      		db	0ffh
1266  FF      		db	0ffh
1267  FF      		db	0ffh
1268  FF      		db	0ffh
1269  FF      		db	0ffh
126A  FF      		db	0ffh
126B  FF      		db	0ffh
126C  FF      		db	0ffh
126D  FF      		db	0ffh
126E  FF      		db	0ffh
126F  FF      		db	0ffh
1270  FF      		db	0ffh
1271  FF      		db	0ffh
1272  FF      		db	0ffh
1273  FF      		db	0ffh
1274  FF      		db	0ffh
1275  FF      		db	0ffh
1276  FF      		db	0ffh
1277  FF      		db	0ffh
1278  FF      		db	0ffh
1279  FF      		db	0ffh
127A  FF      		db	0ffh
127B  FF      		db	0ffh
127C  FF      		db	0ffh
127D  FF      		db	0ffh
127E  FF      		db	0ffh
127F  FF      		db	0ffh
1280  FF      		db	0ffh
1281  FF      		db	0ffh
1282  FF      		db	0ffh
1283  FF      		db	0ffh
1284  FF      		db	0ffh
1285  FF      		db	0ffh
1286  FF      		db	0ffh
1287  FF      		db	0ffh
1288  FF      		db	0ffh
1289  FF      		db	0ffh
128A  FF      		db	0ffh
128B  FF      		db	0ffh
128C  FF      		db	0ffh
128D  FF      		db	0ffh
128E  FF      		db	0ffh
128F  FF      		db	0ffh
1290  FF      		db	0ffh
1291  FF      		db	0ffh
1292  FF      		db	0ffh
1293  FF      		db	0ffh
1294  FF      		db	0ffh
1295  FF      		db	0ffh
1296  FF      		db	0ffh
1297  FF      		db	0ffh
1298  FF      		db	0ffh
1299  FF      		db	0ffh
129A  FF      		db	0ffh
129B  FF      		db	0ffh
129C  FF      		db	0ffh
129D  FF      		db	0ffh
129E  FF      		db	0ffh
129F  FF      		db	0ffh
12A0  FF      		db	0ffh
12A1  FF      		db	0ffh
12A2  FF      		db	0ffh
12A3  FF      		db	0ffh
12A4  FF      		db	0ffh
12A5  FF      		db	0ffh
12A6  FF      		db	0ffh
12A7  FF      		db	0ffh
12A8  FF      		db	0ffh
12A9  FF      		db	0ffh
12AA  FF      		db	0ffh
12AB  FF      		db	0ffh
12AC  FF      		db	0ffh
12AD  FF      		db	0ffh
12AE  FF      		db	0ffh
12AF  FF      		db	0ffh
12B0  FF      		db	0ffh
12B1  FF      		db	0ffh
12B2  FF      		db	0ffh
12B3  FF      		db	0ffh
12B4  FF      		db	0ffh
12B5  FF      		db	0ffh
12B6  FF      		db	0ffh
12B7  FF      		db	0ffh
12B8  FF      		db	0ffh
12B9  FF      		db	0ffh
12BA  FF      		db	0ffh
12BB  FF      		db	0ffh
12BC  FF      		db	0ffh
12BD  FF      		db	0ffh
12BE  FF      		db	0ffh
12BF  FF      		db	0ffh
12C0  FF      		db	0ffh
12C1  FF      		db	0ffh
12C2  FF      		db	0ffh
12C3  FF      		db	0ffh
12C4  FF      		db	0ffh
12C5  FF      		db	0ffh
12C6  FF      		db	0ffh
12C7  FF      		db	0ffh
12C8  FF      		db	0ffh
12C9  FF      		db	0ffh
12CA  FF      		db	0ffh
12CB  FF      		db	0ffh
12CC  FF      		db	0ffh
12CD  FF      		db	0ffh
12CE  FF      		db	0ffh
12CF  FF      		db	0ffh
12D0  FF      		db	0ffh
12D1  FF      		db	0ffh
12D2  FF      		db	0ffh
12D3  FF      		db	0ffh
12D4  FF      		db	0ffh
12D5  FF      		db	0ffh
12D6  FF      		db	0ffh
12D7  FF      		db	0ffh
12D8  FF      		db	0ffh
12D9  FF      		db	0ffh
12DA  FF      		db	0ffh
12DB  FF      		db	0ffh
12DC  FF      		db	0ffh
12DD  FF      		db	0ffh
12DE  FF      		db	0ffh
12DF  FF      		db	0ffh
12E0  FF      		db	0ffh
12E1  FF      		db	0ffh
12E2  FF      		db	0ffh
12E3  FF      		db	0ffh
12E4  FF      		db	0ffh
12E5  FF      		db	0ffh
12E6  FF      		db	0ffh
12E7  FF      		db	0ffh
12E8  FF      		db	0ffh
12E9  FF      		db	0ffh
12EA  FF      		db	0ffh
12EB  FF      		db	0ffh
12EC  FF      		db	0ffh
12ED  FF      		db	0ffh
12EE  FF      		db	0ffh
12EF  FF      		db	0ffh
12F0  FF      		db	0ffh
12F1  FF      		db	0ffh
12F2  FF      		db	0ffh
12F3  FF      		db	0ffh
12F4  FF      		db	0ffh
12F5  FF      		db	0ffh
12F6  FF      		db	0ffh
12F7  FF      		db	0ffh
12F8  FF      		db	0ffh
12F9  FF      		db	0ffh
12FA  FF      		db	0ffh
12FB  FF      		db	0ffh
12FC  FF      		db	0ffh
12FD  FF      		db	0ffh
12FE  FF      		db	0ffh
12FF  FF      		db	0ffh
1300  FF      		db	0ffh
1301  FF      		db	0ffh
1302  FF      		db	0ffh
1303  FF      		db	0ffh
1304  FF      		db	0ffh
1305  FF      		db	0ffh
1306  FF      		db	0ffh
1307  FF      		db	0ffh
1308  FF      		db	0ffh
1309  FF      		db	0ffh
130A  FF      		db	0ffh
130B  FF      		db	0ffh
130C  FF      		db	0ffh
130D  FF      		db	0ffh
130E  FF      		db	0ffh
130F  FF      		db	0ffh
1310  FF      		db	0ffh
1311  FF      		db	0ffh
1312  FF      		db	0ffh
1313  FF      		db	0ffh
1314  FF      		db	0ffh
1315  FF      		db	0ffh
1316  FF      		db	0ffh
1317  FF      		db	0ffh
1318  FF      		db	0ffh
1319  FF      		db	0ffh
131A  FF      		db	0ffh
131B  FF      		db	0ffh
131C  FF      		db	0ffh
131D  FF      		db	0ffh
131E  FF      		db	0ffh
131F  FF      		db	0ffh
1320  FF      		db	0ffh
1321  FF      		db	0ffh
1322  FF      		db	0ffh
1323  FF      		db	0ffh
1324  FF      		db	0ffh
1325  FF      		db	0ffh
1326  FF      		db	0ffh
1327  FF      		db	0ffh
1328  FF      		db	0ffh
1329  FF      		db	0ffh
132A  FF      		db	0ffh
132B  FF      		db	0ffh
132C  FF      		db	0ffh
132D  FF      		db	0ffh
132E  FF      		db	0ffh
132F  FF      		db	0ffh
1330  FF      		db	0ffh
1331  FF      		db	0ffh
1332  FF      		db	0ffh
1333  FF      		db	0ffh
1334  FF      		db	0ffh
1335  FF      		db	0ffh
1336  FF      		db	0ffh
1337  FF      		db	0ffh
1338  FF      		db	0ffh
1339  FF      		db	0ffh
133A  FF      		db	0ffh
133B  FF      		db	0ffh
133C  FF      		db	0ffh
133D  FF      		db	0ffh
133E  FF      		db	0ffh
133F  FF      		db	0ffh
1340  FF      		db	0ffh
1341  FF      		db	0ffh
1342  FF      		db	0ffh
1343  FF      		db	0ffh
1344  FF      		db	0ffh
1345  FF      		db	0ffh
1346  FF      		db	0ffh
1347  FF      		db	0ffh
1348  FF      		db	0ffh
1349  FF      		db	0ffh
134A  FF      		db	0ffh
134B  FF      		db	0ffh
134C  FF      		db	0ffh
134D  FF      		db	0ffh
134E  FF      		db	0ffh
134F  FF      		db	0ffh
1350  FF      		db	0ffh
1351  FF      		db	0ffh
1352  FF      		db	0ffh
1353  FF      		db	0ffh
1354  FF      		db	0ffh
1355  FF      		db	0ffh
1356  FF      		db	0ffh
1357  FF      		db	0ffh
1358  FF      		db	0ffh
1359  FF      		db	0ffh
135A  FF      		db	0ffh
135B  FF      		db	0ffh
135C  FF      		db	0ffh
135D  FF      		db	0ffh
135E  FF      		db	0ffh
135F  FF      		db	0ffh
1360  FF      		db	0ffh
1361  FF      		db	0ffh
1362  FF      		db	0ffh
1363  FF      		db	0ffh
1364  FF      		db	0ffh
1365  FF      		db	0ffh
1366  FF      		db	0ffh
1367  FF      		db	0ffh
1368  FF      		db	0ffh
1369  FF      		db	0ffh
136A  FF      		db	0ffh
136B  FF      		db	0ffh
136C  FF      		db	0ffh
136D  FF      		db	0ffh
136E  FF      		db	0ffh
136F  FF      		db	0ffh
1370  FF      		db	0ffh
1371  FF      		db	0ffh
1372  FF      		db	0ffh
1373  FF      		db	0ffh
1374  FF      		db	0ffh
1375  FF      		db	0ffh
1376  FF      		db	0ffh
1377  FF      		db	0ffh
1378  FF      		db	0ffh
1379  FF      		db	0ffh
137A  FF      		db	0ffh
137B  FF      		db	0ffh
137C  FF      		db	0ffh
137D  FF      		db	0ffh
137E  FF      		db	0ffh
137F  FF      		db	0ffh
1380  FF      		db	0ffh
1381  FF      		db	0ffh
1382  FF      		db	0ffh
1383  FF      		db	0ffh
1384  FF      		db	0ffh
1385  FF      		db	0ffh
1386  FF      		db	0ffh
1387  FF      		db	0ffh
1388  FF      		db	0ffh
1389  FF      		db	0ffh
138A  FF      		db	0ffh
138B  FF      		db	0ffh
138C  FF      		db	0ffh
138D  FF      		db	0ffh
138E  FF      		db	0ffh
138F  FF      		db	0ffh
1390  FF      		db	0ffh
1391  FF      		db	0ffh
1392  FF      		db	0ffh
1393  FF      		db	0ffh
1394  FF      		db	0ffh
1395  FF      		db	0ffh
1396  FF      		db	0ffh
1397  FF      		db	0ffh
1398  FF      		db	0ffh
1399  FF      		db	0ffh
139A  FF      		db	0ffh
139B  FF      		db	0ffh
139C  FF      		db	0ffh
139D  FF      		db	0ffh
139E  FF      		db	0ffh
139F  FF      		db	0ffh
13A0  FF      		db	0ffh
13A1  FF      		db	0ffh
13A2  FF      		db	0ffh
13A3  FF      		db	0ffh
13A4  FF      		db	0ffh
13A5  FF      		db	0ffh
13A6  FF      		db	0ffh
13A7  FF      		db	0ffh
13A8  FF      		db	0ffh
13A9  FF      		db	0ffh
13AA  FF      		db	0ffh
13AB  FF      		db	0ffh
13AC  FF      		db	0ffh
13AD  FF      		db	0ffh
13AE  FF      		db	0ffh
13AF  FF      		db	0ffh
13B0  FF      		db	0ffh
13B1  FF      		db	0ffh
13B2  FF      		db	0ffh
13B3  FF      		db	0ffh
13B4  FF      		db	0ffh
13B5  FF      		db	0ffh
13B6  FF      		db	0ffh
13B7  FF      		db	0ffh
13B8  FF      		db	0ffh
13B9  FF      		db	0ffh
13BA  FF      		db	0ffh
13BB  FF      		db	0ffh
13BC  FF      		db	0ffh
13BD  FF      		db	0ffh
13BE  FF      		db	0ffh
13BF  FF      		db	0ffh
13C0  FF      		db	0ffh
13C1  FF      		db	0ffh
13C2  FF      		db	0ffh
13C3  FF      		db	0ffh
13C4  FF      		db	0ffh
13C5  FF      		db	0ffh
13C6  FF      		db	0ffh
13C7  FF      		db	0ffh
13C8  FF      		db	0ffh
13C9  FF      		db	0ffh
13CA  FF      		db	0ffh
13CB  FF      		db	0ffh
13CC  FF      		db	0ffh
13CD  FF      		db	0ffh
13CE  FF      		db	0ffh
13CF  FF      		db	0ffh
13D0  FF      		db	0ffh
13D1  FF      		db	0ffh
13D2  FF      		db	0ffh
13D3  FF      		db	0ffh
13D4  FF      		db	0ffh
13D5  FF      		db	0ffh
13D6  FF      		db	0ffh
13D7  FF      		db	0ffh
13D8  FF      		db	0ffh
13D9  FF      		db	0ffh
13DA  FF      		db	0ffh
13DB  FF      		db	0ffh
13DC  FF      		db	0ffh
13DD  FF      		db	0ffh
13DE  FF      		db	0ffh
13DF  FF      		db	0ffh
13E0  FF      		db	0ffh
13E1  FF      		db	0ffh
13E2  FF      		db	0ffh
13E3  FF      		db	0ffh
13E4  FF      		db	0ffh
13E5  FF      		db	0ffh
13E6  FF      		db	0ffh
13E7  FF      		db	0ffh
13E8  FF      		db	0ffh
13E9  FF      		db	0ffh
13EA  FF      		db	0ffh
13EB  FF      		db	0ffh
13EC  FF      		db	0ffh
13ED  FF      		db	0ffh
13EE  FF      		db	0ffh
13EF  FF      		db	0ffh
13F0  FF      		db	0ffh
13F1  FF      		db	0ffh
13F2  FF      		db	0ffh
13F3  FF      		db	0ffh
13F4  FF      		db	0ffh
13F5  FF      		db	0ffh
13F6  FF      		db	0ffh
13F7  FF      		db	0ffh
13F8  FF      		db	0ffh
13F9  FF      		db	0ffh
13FA  FF      		db	0ffh
13FB  FF      		db	0ffh
13FC  FF      		db	0ffh
13FD  FF      		db	0ffh
13FE  FF      		db	0ffh
13FF  FF      		db	0ffh
1400  FF      		db	0ffh
1401  FF      		db	0ffh
1402  FF      		db	0ffh
1403  FF      		db	0ffh
1404  FF      		db	0ffh
1405  FF      		db	0ffh
1406  FF      		db	0ffh
1407  FF      		db	0ffh
1408  FF      		db	0ffh
1409  FF      		db	0ffh
140A  FF      		db	0ffh
140B  FF      		db	0ffh
140C  FF      		db	0ffh
140D  FF      		db	0ffh
140E  FF      		db	0ffh
140F  FF      		db	0ffh
1410  FF      		db	0ffh
1411  FF      		db	0ffh
1412  FF      		db	0ffh
1413  FF      		db	0ffh
1414  FF      		db	0ffh
1415  FF      		db	0ffh
1416  FF      		db	0ffh
1417  FF      		db	0ffh
1418  FF      		db	0ffh
1419  FF      		db	0ffh
141A  FF      		db	0ffh
141B  FF      		db	0ffh
141C  FF      		db	0ffh
141D  FF      		db	0ffh
141E  FF      		db	0ffh
141F  FF      		db	0ffh
1420  FF      		db	0ffh
1421  FF      		db	0ffh
1422  FF      		db	0ffh
1423  FF      		db	0ffh
1424  FF      		db	0ffh
1425  FF      		db	0ffh
1426  FF      		db	0ffh
1427  FF      		db	0ffh
1428  FF      		db	0ffh
1429  FF      		db	0ffh
142A  FF      		db	0ffh
142B  FF      		db	0ffh
142C  FF      		db	0ffh
142D  FF      		db	0ffh
142E  FF      		db	0ffh
142F  FF      		db	0ffh
1430  FF      		db	0ffh
1431  FF      		db	0ffh
1432  FF      		db	0ffh
1433  FF      		db	0ffh
1434  FF      		db	0ffh
1435  FF      		db	0ffh
1436  FF      		db	0ffh
1437  FF      		db	0ffh
1438  FF      		db	0ffh
1439  FF      		db	0ffh
143A  FF      		db	0ffh
143B  FF      		db	0ffh
143C  FF      		db	0ffh
143D  FF      		db	0ffh
143E  FF      		db	0ffh
143F  FF      		db	0ffh
1440  FF      		db	0ffh
1441  FF      		db	0ffh
1442  FF      		db	0ffh
1443  FF      		db	0ffh
1444  FF      		db	0ffh
1445  FF      		db	0ffh
1446  FF      		db	0ffh
1447  FF      		db	0ffh
1448  FF      		db	0ffh
1449  FF      		db	0ffh
144A  FF      		db	0ffh
144B  FF      		db	0ffh
144C  FF      		db	0ffh
144D  FF      		db	0ffh
144E  FF      		db	0ffh
144F  FF      		db	0ffh
1450  FF      		db	0ffh
1451  FF      		db	0ffh
1452  FF      		db	0ffh
1453  FF      		db	0ffh
1454  FF      		db	0ffh
1455  FF      		db	0ffh
1456  FF      		db	0ffh
1457  FF      		db	0ffh
1458  FF      		db	0ffh
1459  FF      		db	0ffh
145A  FF      		db	0ffh
145B  FF      		db	0ffh
145C  FF      		db	0ffh
145D  FF      		db	0ffh
145E  FF      		db	0ffh
145F  FF      		db	0ffh
1460  FF      		db	0ffh
1461  FF      		db	0ffh
1462  FF      		db	0ffh
1463  FF      		db	0ffh
1464  FF      		db	0ffh
1465  FF      		db	0ffh
1466  FF      		db	0ffh
1467  FF      		db	0ffh
1468  FF      		db	0ffh
1469  FF      		db	0ffh
146A  FF      		db	0ffh
146B  FF      		db	0ffh
146C  FF      		db	0ffh
146D  FF      		db	0ffh
146E  FF      		db	0ffh
146F  FF      		db	0ffh
1470  FF      		db	0ffh
1471  FF      		db	0ffh
1472  FF      		db	0ffh
1473  FF      		db	0ffh
1474  FF      		db	0ffh
1475  FF      		db	0ffh
1476  FF      		db	0ffh
1477  FF      		db	0ffh
1478  FF      		db	0ffh
1479  FF      		db	0ffh
147A  FF      		db	0ffh
147B  FF      		db	0ffh
147C  FF      		db	0ffh
147D  FF      		db	0ffh
147E  FF      		db	0ffh
147F  FF      		db	0ffh
1480  FF      		db	0ffh
1481  FF      		db	0ffh
1482  FF      		db	0ffh
1483  FF      		db	0ffh
1484  FF      		db	0ffh
1485  FF      		db	0ffh
1486  FF      		db	0ffh
1487  FF      		db	0ffh
1488  FF      		db	0ffh
1489  FF      		db	0ffh
148A  FF      		db	0ffh
148B  FF      		db	0ffh
148C  FF      		db	0ffh
148D  FF      		db	0ffh
148E  FF      		db	0ffh
148F  FF      		db	0ffh
1490  FF      		db	0ffh
1491  FF      		db	0ffh
1492  FF      		db	0ffh
1493  FF      		db	0ffh
1494  FF      		db	0ffh
1495  FF      		db	0ffh
1496  FF      		db	0ffh
1497  FF      		db	0ffh
1498  FF      		db	0ffh
1499  FF      		db	0ffh
149A  FF      		db	0ffh
149B  FF      		db	0ffh
149C  FF      		db	0ffh
149D  FF      		db	0ffh
149E  FF      		db	0ffh
149F  FF      		db	0ffh
14A0  FF      		db	0ffh
14A1  FF      		db	0ffh
14A2  FF      		db	0ffh
14A3  FF      		db	0ffh
14A4  FF      		db	0ffh
14A5  FF      		db	0ffh
14A6  FF      		db	0ffh
14A7  FF      		db	0ffh
14A8  FF      		db	0ffh
14A9  FF      		db	0ffh
14AA  FF      		db	0ffh
14AB  FF      		db	0ffh
14AC  FF      		db	0ffh
14AD  FF      		db	0ffh
14AE  FF      		db	0ffh
14AF  FF      		db	0ffh
14B0  FF      		db	0ffh
14B1  FF      		db	0ffh
14B2  FF      		db	0ffh
14B3  FF      		db	0ffh
14B4  FF      		db	0ffh
14B5  FF      		db	0ffh
14B6  FF      		db	0ffh
14B7  FF      		db	0ffh
14B8  FF      		db	0ffh
14B9  FF      		db	0ffh
14BA  FF      		db	0ffh
14BB  FF      		db	0ffh
14BC  FF      		db	0ffh
14BD  FF      		db	0ffh
14BE  FF      		db	0ffh
14BF  FF      		db	0ffh
14C0  FF      		db	0ffh
14C1  FF      		db	0ffh
14C2  FF      		db	0ffh
14C3  FF      		db	0ffh
14C4  FF      		db	0ffh
14C5  FF      		db	0ffh
14C6  FF      		db	0ffh
14C7  FF      		db	0ffh
14C8  FF      		db	0ffh
14C9  FF      		db	0ffh
14CA  FF      		db	0ffh
14CB  FF      		db	0ffh
14CC  FF      		db	0ffh
14CD  FF      		db	0ffh
14CE  FF      		db	0ffh
14CF  FF      		db	0ffh
14D0  FF      		db	0ffh
14D1  FF      		db	0ffh
14D2  FF      		db	0ffh
14D3  FF      		db	0ffh
14D4  FF      		db	0ffh
14D5  FF      		db	0ffh
14D6  FF      		db	0ffh
14D7  FF      		db	0ffh
14D8  FF      		db	0ffh
14D9  FF      		db	0ffh
14DA  FF      		db	0ffh
14DB  FF      		db	0ffh
14DC  FF      		db	0ffh
14DD  FF      		db	0ffh
14DE  FF      		db	0ffh
14DF  FF      		db	0ffh
14E0  FF      		db	0ffh
14E1  FF      		db	0ffh
14E2  FF      		db	0ffh
14E3  FF      		db	0ffh
14E4  FF      		db	0ffh
14E5  FF      		db	0ffh
14E6  FF      		db	0ffh
14E7  FF      		db	0ffh
14E8  FF      		db	0ffh
14E9  FF      		db	0ffh
14EA  FF      		db	0ffh
14EB  FF      		db	0ffh
14EC  FF      		db	0ffh
14ED  FF      		db	0ffh
14EE  FF      		db	0ffh
14EF  FF      		db	0ffh
14F0  FF      		db	0ffh
14F1  FF      		db	0ffh
14F2  FF      		db	0ffh
14F3  FF      		db	0ffh
14F4  FF      		db	0ffh
14F5  FF      		db	0ffh
14F6  FF      		db	0ffh
14F7  FF      		db	0ffh
14F8  FF      		db	0ffh
14F9  FF      		db	0ffh
14FA  FF      		db	0ffh
14FB  FF      		db	0ffh
14FC  FF      		db	0ffh
14FD  FF      		db	0ffh
14FE  FF      		db	0ffh
14FF  FF      		db	0ffh
1500  FF      		db	0ffh
1501  FF      		db	0ffh
1502  FF      		db	0ffh
1503  FF      		db	0ffh
1504  FF      		db	0ffh
1505  FF      		db	0ffh
1506  FF      		db	0ffh
1507  FF      		db	0ffh
1508  FF      		db	0ffh
1509  FF      		db	0ffh
150A  FF      		db	0ffh
150B  FF      		db	0ffh
150C  FF      		db	0ffh
150D  FF      		db	0ffh
150E  FF      		db	0ffh
150F  FF      		db	0ffh
1510  FF      		db	0ffh
1511  FF      		db	0ffh
1512  FF      		db	0ffh
1513  FF      		db	0ffh
1514  FF      		db	0ffh
1515  FF      		db	0ffh
1516  FF      		db	0ffh
1517  FF      		db	0ffh
1518  FF      		db	0ffh
1519  FF      		db	0ffh
151A  FF      		db	0ffh
151B  FF      		db	0ffh
151C  FF      		db	0ffh
151D  FF      		db	0ffh
151E  FF      		db	0ffh
151F  FF      		db	0ffh
1520  FF      		db	0ffh
1521  FF      		db	0ffh
1522  FF      		db	0ffh
1523  FF      		db	0ffh
1524  FF      		db	0ffh
1525  FF      		db	0ffh
1526  FF      		db	0ffh
1527  FF      		db	0ffh
1528  FF      		db	0ffh
1529  FF      		db	0ffh
152A  FF      		db	0ffh
152B  FF      		db	0ffh
152C  FF      		db	0ffh
152D  FF      		db	0ffh
152E  FF      		db	0ffh
152F  FF      		db	0ffh
1530  FF      		db	0ffh
1531  FF      		db	0ffh
1532  FF      		db	0ffh
1533  FF      		db	0ffh
1534  FF      		db	0ffh
1535  FF      		db	0ffh
1536  FF      		db	0ffh
1537  FF      		db	0ffh
1538  FF      		db	0ffh
1539  FF      		db	0ffh
153A  FF      		db	0ffh
153B  FF      		db	0ffh
153C  FF      		db	0ffh
153D  FF      		db	0ffh
153E  FF      		db	0ffh
153F  FF      		db	0ffh
1540  FF      		db	0ffh
1541  FF      		db	0ffh
1542  FF      		db	0ffh
1543  FF      		db	0ffh
1544  FF      		db	0ffh
1545  FF      		db	0ffh
1546  FF      		db	0ffh
1547  FF      		db	0ffh
1548  FF      		db	0ffh
1549  FF      		db	0ffh
154A  FF      		db	0ffh
154B  FF      		db	0ffh
154C  FF      		db	0ffh
154D  FF      		db	0ffh
154E  FF      		db	0ffh
154F  FF      		db	0ffh
1550  FF      		db	0ffh
1551  FF      		db	0ffh
1552  FF      		db	0ffh
1553  FF      		db	0ffh
1554  FF      		db	0ffh
1555  FF      		db	0ffh
1556  FF      		db	0ffh
1557  FF      		db	0ffh
1558  FF      		db	0ffh
1559  FF      		db	0ffh
155A  FF      		db	0ffh
155B  FF      		db	0ffh
155C  FF      		db	0ffh
155D  FF      		db	0ffh
155E  FF      		db	0ffh
155F  FF      		db	0ffh
1560  FF      		db	0ffh
1561  FF      		db	0ffh
1562  FF      		db	0ffh
1563  FF      		db	0ffh
1564  FF      		db	0ffh
1565  FF      		db	0ffh
1566  FF      		db	0ffh
1567  FF      		db	0ffh
1568  FF      		db	0ffh
1569  FF      		db	0ffh
156A  FF      		db	0ffh
156B  FF      		db	0ffh
156C  FF      		db	0ffh
156D  FF      		db	0ffh
156E  FF      		db	0ffh
156F  FF      		db	0ffh
1570  FF      		db	0ffh
1571  FF      		db	0ffh
1572  FF      		db	0ffh
1573  FF      		db	0ffh
1574  FF      		db	0ffh
1575  FF      		db	0ffh
1576  FF      		db	0ffh
1577  FF      		db	0ffh
1578  FF      		db	0ffh
1579  FF      		db	0ffh
157A  FF      		db	0ffh
157B  FF      		db	0ffh
157C  FF      		db	0ffh
157D  FF      		db	0ffh
157E  FF      		db	0ffh
157F  FF      		db	0ffh
1580  FF      		db	0ffh
1581  FF      		db	0ffh
1582  FF      		db	0ffh
1583  FF      		db	0ffh
1584  FF      		db	0ffh
1585  FF      		db	0ffh
1586  FF      		db	0ffh
1587  FF      		db	0ffh
1588  FF      		db	0ffh
1589  FF      		db	0ffh
158A  FF      		db	0ffh
158B  FF      		db	0ffh
158C  FF      		db	0ffh
158D  FF      		db	0ffh
158E  FF      		db	0ffh
158F  FF      		db	0ffh
1590  FF      		db	0ffh
1591  FF      		db	0ffh
1592  FF      		db	0ffh
1593  FF      		db	0ffh
1594  FF      		db	0ffh
1595  FF      		db	0ffh
1596  FF      		db	0ffh
1597  FF      		db	0ffh
1598  FF      		db	0ffh
1599  FF      		db	0ffh
159A  FF      		db	0ffh
159B  FF      		db	0ffh
159C  FF      		db	0ffh
159D  FF      		db	0ffh
159E  FF      		db	0ffh
159F  FF      		db	0ffh
15A0  FF      		db	0ffh
15A1  FF      		db	0ffh
15A2  FF      		db	0ffh
15A3  FF      		db	0ffh
15A4  FF      		db	0ffh
15A5  FF      		db	0ffh
15A6  FF      		db	0ffh
15A7  FF      		db	0ffh
15A8  FF      		db	0ffh
15A9  FF      		db	0ffh
15AA  FF      		db	0ffh
15AB  FF      		db	0ffh
15AC  FF      		db	0ffh
15AD  FF      		db	0ffh
15AE  FF      		db	0ffh
15AF  FF      		db	0ffh
15B0  FF      		db	0ffh
15B1  FF      		db	0ffh
15B2  FF      		db	0ffh
15B3  FF      		db	0ffh
15B4  FF      		db	0ffh
15B5  FF      		db	0ffh
15B6  FF      		db	0ffh
15B7  FF      		db	0ffh
15B8  FF      		db	0ffh
15B9  FF      		db	0ffh
15BA  FF      		db	0ffh
15BB  FF      		db	0ffh
15BC  FF      		db	0ffh
15BD  FF      		db	0ffh
15BE  FF      		db	0ffh
15BF  FF      		db	0ffh
15C0  FF      		db	0ffh
15C1  FF      		db	0ffh
15C2  FF      		db	0ffh
15C3  FF      		db	0ffh
15C4  FF      		db	0ffh
15C5  FF      		db	0ffh
15C6  FF      		db	0ffh
15C7  FF      		db	0ffh
15C8  FF      		db	0ffh
15C9  FF      		db	0ffh
15CA  FF      		db	0ffh
15CB  FF      		db	0ffh
15CC  FF      		db	0ffh
15CD  FF      		db	0ffh
15CE  FF      		db	0ffh
15CF  FF      		db	0ffh
15D0  FF      		db	0ffh
15D1  FF      		db	0ffh
15D2  FF      		db	0ffh
15D3  FF      		db	0ffh
15D4  FF      		db	0ffh
15D5  FF      		db	0ffh
15D6  FF      		db	0ffh
15D7  FF      		db	0ffh
15D8  FF      		db	0ffh
15D9  FF      		db	0ffh
15DA  FF      		db	0ffh
15DB  FF      		db	0ffh
15DC  FF      		db	0ffh
15DD  FF      		db	0ffh
15DE  FF      		db	0ffh
15DF  FF      		db	0ffh
15E0  FF      		db	0ffh
15E1  FF      		db	0ffh
15E2  FF      		db	0ffh
15E3  FF      		db	0ffh
15E4  FF      		db	0ffh
15E5  FF      		db	0ffh
15E6  FF      		db	0ffh
15E7  FF      		db	0ffh
15E8  FF      		db	0ffh
15E9  FF      		db	0ffh
15EA  FF      		db	0ffh
15EB  FF      		db	0ffh
15EC  FF      		db	0ffh
15ED  FF      		db	0ffh
15EE  FF      		db	0ffh
15EF  FF      		db	0ffh
15F0  FF      		db	0ffh
15F1  FF      		db	0ffh
15F2  FF      		db	0ffh
15F3  FF      		db	0ffh
15F4  FF      		db	0ffh
15F5  FF      		db	0ffh
15F6  FF      		db	0ffh
15F7  FF      		db	0ffh
15F8  FF      		db	0ffh
15F9  FF      		db	0ffh
15FA  FF      		db	0ffh
15FB  FF      		db	0ffh
15FC  FF      		db	0ffh
15FD  FF      		db	0ffh
15FE  FF      		db	0ffh
15FF  FF      		db	0ffh
1600  FF      		db	0ffh
1601  FF      		db	0ffh
1602  FF      		db	0ffh
1603  FF      		db	0ffh
1604  FF      		db	0ffh
1605  FF      		db	0ffh
1606  FF      		db	0ffh
1607  FF      		db	0ffh
1608  FF      		db	0ffh
1609  FF      		db	0ffh
160A  FF      		db	0ffh
160B  FF      		db	0ffh
160C  FF      		db	0ffh
160D  FF      		db	0ffh
160E  FF      		db	0ffh
160F  FF      		db	0ffh
1610  FF      		db	0ffh
1611  FF      		db	0ffh
1612  FF      		db	0ffh
1613  FF      		db	0ffh
1614  FF      		db	0ffh
1615  FF      		db	0ffh
1616  FF      		db	0ffh
1617  FF      		db	0ffh
1618  FF      		db	0ffh
1619  FF      		db	0ffh
161A  FF      		db	0ffh
161B  FF      		db	0ffh
161C  FF      		db	0ffh
161D  FF      		db	0ffh
161E  FF      		db	0ffh
161F  FF      		db	0ffh
1620  FF      		db	0ffh
1621  FF      		db	0ffh
1622  FF      		db	0ffh
1623  FF      		db	0ffh
1624  FF      		db	0ffh
1625  FF      		db	0ffh
1626  FF      		db	0ffh
1627  FF      		db	0ffh
1628  FF      		db	0ffh
1629  FF      		db	0ffh
162A  FF      		db	0ffh
162B  FF      		db	0ffh
162C  FF      		db	0ffh
162D  FF      		db	0ffh
162E  FF      		db	0ffh
162F  FF      		db	0ffh
1630  FF      		db	0ffh
1631  FF      		db	0ffh
1632  FF      		db	0ffh
1633  FF      		db	0ffh
1634  FF      		db	0ffh
1635  FF      		db	0ffh
1636  FF      		db	0ffh
1637  FF      		db	0ffh
1638  FF      		db	0ffh
1639  FF      		db	0ffh
163A  FF      		db	0ffh
163B  FF      		db	0ffh
163C  FF      		db	0ffh
163D  FF      		db	0ffh
163E  FF      		db	0ffh
163F  FF      		db	0ffh
1640  FF      		db	0ffh
1641  FF      		db	0ffh
1642  FF      		db	0ffh
1643  FF      		db	0ffh
1644  FF      		db	0ffh
1645  FF      		db	0ffh
1646  FF      		db	0ffh
1647  FF      		db	0ffh
1648  FF      		db	0ffh
1649  FF      		db	0ffh
164A  FF      		db	0ffh
164B  FF      		db	0ffh
164C  FF      		db	0ffh
164D  FF      		db	0ffh
164E  FF      		db	0ffh
164F  FF      		db	0ffh
1650  FF      		db	0ffh
1651  FF      		db	0ffh
1652  FF      		db	0ffh
1653  FF      		db	0ffh
1654  FF      		db	0ffh
1655  FF      		db	0ffh
1656  FF      		db	0ffh
1657  FF      		db	0ffh
1658  FF      		db	0ffh
1659  FF      		db	0ffh
165A  FF      		db	0ffh
165B  FF      		db	0ffh
165C  FF      		db	0ffh
165D  FF      		db	0ffh
165E  FF      		db	0ffh
165F  FF      		db	0ffh
1660  FF      		db	0ffh
1661  FF      		db	0ffh
1662  FF      		db	0ffh
1663  FF      		db	0ffh
1664  FF      		db	0ffh
1665  FF      		db	0ffh
1666  FF      		db	0ffh
1667  FF      		db	0ffh
1668  FF      		db	0ffh
1669  FF      		db	0ffh
166A  FF      		db	0ffh
166B  FF      		db	0ffh
166C  FF      		db	0ffh
166D  FF      		db	0ffh
166E  FF      		db	0ffh
166F  FF      		db	0ffh
1670  FF      		db	0ffh
1671  FF      		db	0ffh
1672  FF      		db	0ffh
1673  FF      		db	0ffh
1674  FF      		db	0ffh
1675  FF      		db	0ffh
1676  FF      		db	0ffh
1677  FF      		db	0ffh
1678  FF      		db	0ffh
1679  FF      		db	0ffh
167A  FF      		db	0ffh
167B  FF      		db	0ffh
167C  FF      		db	0ffh
167D  FF      		db	0ffh
167E  FF      		db	0ffh
167F  FF      		db	0ffh
1680  FF      		db	0ffh
1681  FF      		db	0ffh
1682  FF      		db	0ffh
1683  FF      		db	0ffh
1684  FF      		db	0ffh
1685  FF      		db	0ffh
1686  FF      		db	0ffh
1687  FF      		db	0ffh
1688  FF      		db	0ffh
1689  FF      		db	0ffh
168A  FF      		db	0ffh
168B  FF      		db	0ffh
168C  FF      		db	0ffh
168D  FF      		db	0ffh
168E  FF      		db	0ffh
168F  FF      		db	0ffh
1690  FF      		db	0ffh
1691  FF      		db	0ffh
1692  FF      		db	0ffh
1693  FF      		db	0ffh
1694  FF      		db	0ffh
1695  FF      		db	0ffh
1696  FF      		db	0ffh
1697  FF      		db	0ffh
1698  FF      		db	0ffh
1699  FF      		db	0ffh
169A  FF      		db	0ffh
169B  FF      		db	0ffh
169C  FF      		db	0ffh
169D  FF      		db	0ffh
169E  FF      		db	0ffh
169F  FF      		db	0ffh
16A0  FF      		db	0ffh
16A1  FF      		db	0ffh
16A2  FF      		db	0ffh
16A3  FF      		db	0ffh
16A4  FF      		db	0ffh
16A5  FF      		db	0ffh
16A6  FF      		db	0ffh
16A7  FF      		db	0ffh
16A8  FF      		db	0ffh
16A9  FF      		db	0ffh
16AA  FF      		db	0ffh
16AB  FF      		db	0ffh
16AC  FF      		db	0ffh
16AD  FF      		db	0ffh
16AE  FF      		db	0ffh
16AF  FF      		db	0ffh
16B0  FF      		db	0ffh
16B1  FF      		db	0ffh
16B2  FF      		db	0ffh
16B3  FF      		db	0ffh
16B4  FF      		db	0ffh
16B5  FF      		db	0ffh
16B6  FF      		db	0ffh
16B7  FF      		db	0ffh
16B8  FF      		db	0ffh
16B9  FF      		db	0ffh
16BA  FF      		db	0ffh
16BB  FF      		db	0ffh
16BC  FF      		db	0ffh
16BD  FF      		db	0ffh
16BE  FF      		db	0ffh
16BF  FF      		db	0ffh
16C0  FF      		db	0ffh
16C1  FF      		db	0ffh
16C2  FF      		db	0ffh
16C3  FF      		db	0ffh
16C4  FF      		db	0ffh
16C5  FF      		db	0ffh
16C6  FF      		db	0ffh
16C7  FF      		db	0ffh
16C8  FF      		db	0ffh
16C9  FF      		db	0ffh
16CA  FF      		db	0ffh
16CB  FF      		db	0ffh
16CC  FF      		db	0ffh
16CD  FF      		db	0ffh
16CE  FF      		db	0ffh
16CF  FF      		db	0ffh
16D0  FF      		db	0ffh
16D1  FF      		db	0ffh
16D2  FF      		db	0ffh
16D3  FF      		db	0ffh
16D4  FF      		db	0ffh
16D5  FF      		db	0ffh
16D6  FF      		db	0ffh
16D7  FF      		db	0ffh
16D8  FF      		db	0ffh
16D9  FF      		db	0ffh
16DA  FF      		db	0ffh
16DB  FF      		db	0ffh
16DC  FF      		db	0ffh
16DD  FF      		db	0ffh
16DE  FF      		db	0ffh
16DF  FF      		db	0ffh
16E0  FF      		db	0ffh
16E1  FF      		db	0ffh
16E2  FF      		db	0ffh
16E3  FF      		db	0ffh
16E4  FF      		db	0ffh
16E5  FF      		db	0ffh
16E6  FF      		db	0ffh
16E7  FF      		db	0ffh
16E8  FF      		db	0ffh
16E9  FF      		db	0ffh
16EA  FF      		db	0ffh
16EB  FF      		db	0ffh
16EC  FF      		db	0ffh
16ED  FF      		db	0ffh
16EE  FF      		db	0ffh
16EF  FF      		db	0ffh
16F0  FF      		db	0ffh
16F1  FF      		db	0ffh
16F2  FF      		db	0ffh
16F3  FF      		db	0ffh
16F4  FF      		db	0ffh
16F5  FF      		db	0ffh
16F6  FF      		db	0ffh
16F7  FF      		db	0ffh
16F8  FF      		db	0ffh
16F9  FF      		db	0ffh
16FA  FF      		db	0ffh
16FB  FF      		db	0ffh
16FC  FF      		db	0ffh
16FD  FF      		db	0ffh
16FE  FF      		db	0ffh
16FF  FF      		db	0ffh
1700  FF      		db	0ffh
1701  FF      		db	0ffh
1702  FF      		db	0ffh
1703  FF      		db	0ffh
1704  FF      		db	0ffh
1705  FF      		db	0ffh
1706  FF      		db	0ffh
1707  FF      		db	0ffh
1708  FF      		db	0ffh
1709  FF      		db	0ffh
170A  FF      		db	0ffh
170B  FF      		db	0ffh
170C  FF      		db	0ffh
170D  FF      		db	0ffh
170E  FF      		db	0ffh
170F  FF      		db	0ffh
1710  FF      		db	0ffh
1711  FF      		db	0ffh
1712  FF      		db	0ffh
1713  FF      		db	0ffh
1714  FF      		db	0ffh
1715  FF      		db	0ffh
1716  FF      		db	0ffh
1717  FF      		db	0ffh
1718  FF      		db	0ffh
1719  FF      		db	0ffh
171A  FF      		db	0ffh
171B  FF      		db	0ffh
171C  FF      		db	0ffh
171D  FF      		db	0ffh
171E  FF      		db	0ffh
171F  FF      		db	0ffh
1720  FF      		db	0ffh
1721  FF      		db	0ffh
1722  FF      		db	0ffh
1723  FF      		db	0ffh
1724  FF      		db	0ffh
1725  FF      		db	0ffh
1726  FF      		db	0ffh
1727  FF      		db	0ffh
1728  FF      		db	0ffh
1729  FF      		db	0ffh
172A  FF      		db	0ffh
172B  FF      		db	0ffh
172C  FF      		db	0ffh
172D  FF      		db	0ffh
172E  FF      		db	0ffh
172F  FF      		db	0ffh
1730  FF      		db	0ffh
1731  FF      		db	0ffh
1732  FF      		db	0ffh
1733  FF      		db	0ffh
1734  FF      		db	0ffh
1735  FF      		db	0ffh
1736  FF      		db	0ffh
1737  FF      		db	0ffh
1738  FF      		db	0ffh
1739  FF      		db	0ffh
173A  FF      		db	0ffh
173B  FF      		db	0ffh
173C  FF      		db	0ffh
173D  FF      		db	0ffh
173E  FF      		db	0ffh
173F  FF      		db	0ffh
1740  FF      		db	0ffh
1741  FF      		db	0ffh
1742  FF      		db	0ffh
1743  FF      		db	0ffh
1744  FF      		db	0ffh
1745  FF      		db	0ffh
1746  FF      		db	0ffh
1747  FF      		db	0ffh
1748  FF      		db	0ffh
1749  FF      		db	0ffh
174A  FF      		db	0ffh
174B  FF      		db	0ffh
174C  FF      		db	0ffh
174D  FF      		db	0ffh
174E  FF      		db	0ffh
174F  FF      		db	0ffh
1750  FF      		db	0ffh
1751  FF      		db	0ffh
1752  FF      		db	0ffh
1753  FF      		db	0ffh
1754  FF      		db	0ffh
1755  FF      		db	0ffh
1756  FF      		db	0ffh
1757  FF      		db	0ffh
1758  FF      		db	0ffh
1759  FF      		db	0ffh
175A  FF      		db	0ffh
175B  FF      		db	0ffh
175C  FF      		db	0ffh
175D  FF      		db	0ffh
175E  FF      		db	0ffh
175F  FF      		db	0ffh
1760  FF      		db	0ffh
1761  FF      		db	0ffh
1762  FF      		db	0ffh
1763  FF      		db	0ffh
1764  FF      		db	0ffh
1765  FF      		db	0ffh
1766  FF      		db	0ffh
1767  FF      		db	0ffh
1768  FF      		db	0ffh
1769  FF      		db	0ffh
176A  FF      		db	0ffh
176B  FF      		db	0ffh
176C  FF      		db	0ffh
176D  FF      		db	0ffh
176E  FF      		db	0ffh
176F  FF      		db	0ffh
1770  FF      		db	0ffh
1771  FF      		db	0ffh
1772  FF      		db	0ffh
1773  FF      		db	0ffh
1774  FF      		db	0ffh
1775  FF      		db	0ffh
1776  FF      		db	0ffh
1777  FF      		db	0ffh
1778  FF      		db	0ffh
1779  FF      		db	0ffh
177A  FF      		db	0ffh
177B  FF      		db	0ffh
177C  FF      		db	0ffh
177D  FF      		db	0ffh
177E  FF      		db	0ffh
177F  FF      		db	0ffh
1780  FF      		db	0ffh
1781  FF      		db	0ffh
1782  FF      		db	0ffh
1783  FF      		db	0ffh
1784  FF      		db	0ffh
1785  FF      		db	0ffh
1786  FF      		db	0ffh
1787  FF      		db	0ffh
1788  FF      		db	0ffh
1789  FF      		db	0ffh
178A  FF      		db	0ffh
178B  FF      		db	0ffh
178C  FF      		db	0ffh
178D  FF      		db	0ffh
178E  FF      		db	0ffh
178F  FF      		db	0ffh
1790  FF      		db	0ffh
1791  FF      		db	0ffh
1792  FF      		db	0ffh
1793  FF      		db	0ffh
1794  FF      		db	0ffh
1795  FF      		db	0ffh
1796  FF      		db	0ffh
1797  FF      		db	0ffh
1798  FF      		db	0ffh
1799  FF      		db	0ffh
179A  FF      		db	0ffh
179B  FF      		db	0ffh
179C  FF      		db	0ffh
179D  FF      		db	0ffh
179E  FF      		db	0ffh
179F  FF      		db	0ffh
17A0  FF      		db	0ffh
17A1  FF      		db	0ffh
17A2  FF      		db	0ffh
17A3  FF      		db	0ffh
17A4  FF      		db	0ffh
17A5  FF      		db	0ffh
17A6  FF      		db	0ffh
17A7  FF      		db	0ffh
17A8  FF      		db	0ffh
17A9  FF      		db	0ffh
17AA  FF      		db	0ffh
17AB  FF      		db	0ffh
17AC  FF      		db	0ffh
17AD  FF      		db	0ffh
17AE  FF      		db	0ffh
17AF  FF      		db	0ffh
17B0  FF      		db	0ffh
17B1  FF      		db	0ffh
17B2  FF      		db	0ffh
17B3  FF      		db	0ffh
17B4  FF      		db	0ffh
17B5  FF      		db	0ffh
17B6  FF      		db	0ffh
17B7  FF      		db	0ffh
17B8  FF      		db	0ffh
17B9  FF      		db	0ffh
17BA  FF      		db	0ffh
17BB  FF      		db	0ffh
17BC  FF      		db	0ffh
17BD  FF      		db	0ffh
17BE  FF      		db	0ffh
17BF  FF      		db	0ffh
17C0  FF      		db	0ffh
17C1  FF      		db	0ffh
17C2  FF      		db	0ffh
17C3  FF      		db	0ffh
17C4  FF      		db	0ffh
17C5  FF      		db	0ffh
17C6  FF      		db	0ffh
17C7  FF      		db	0ffh
17C8  FF      		db	0ffh
17C9  FF      		db	0ffh
17CA  FF      		db	0ffh
17CB  FF      		db	0ffh
17CC  FF      		db	0ffh
17CD  FF      		db	0ffh
17CE  FF      		db	0ffh
17CF  FF      		db	0ffh
17D0  FF      		db	0ffh
17D1  FF      		db	0ffh
17D2  FF      		db	0ffh
17D3  FF      		db	0ffh
17D4  FF      		db	0ffh
17D5  FF      		db	0ffh
17D6  FF      		db	0ffh
17D7  FF      		db	0ffh
17D8  FF      		db	0ffh
17D9  FF      		db	0ffh
17DA  FF      		db	0ffh
17DB  FF      		db	0ffh
17DC  FF      		db	0ffh
17DD  FF      		db	0ffh
17DE  FF      		db	0ffh
17DF  FF      		db	0ffh
17E0  FF      		db	0ffh
17E1  FF      		db	0ffh
17E2  FF      		db	0ffh
17E3  FF      		db	0ffh
17E4  FF      		db	0ffh
17E5  FF      		db	0ffh
17E6  FF      		db	0ffh
17E7  FF      		db	0ffh
17E8  FF      		db	0ffh
17E9  FF      		db	0ffh
17EA  FF      		db	0ffh
17EB  FF      		db	0ffh
17EC  FF      		db	0ffh
17ED  FF      		db	0ffh
17EE  FF      		db	0ffh
17EF  FF      		db	0ffh
17F0  FF      		db	0ffh
17F1  FF      		db	0ffh
17F2  FF      		db	0ffh
17F3  FF      		db	0ffh
17F4  FF      		db	0ffh
17F5  FF      		db	0ffh
17F6  FF      		db	0ffh
17F7  FF      		db	0ffh
17F8  FF      		db	0ffh
17F9  FF      		db	0ffh
17FA  FF      		db	0ffh
17FB  FF      		db	0ffh
17FC  FF      		db	0ffh
17FD  FF      		db	0ffh
17FE  FF      		db	0ffh
17FF  FF      		db	0ffh
0000          	if	($ <> 1800h)
		endif
1800          		end



Statistics:

     4	passes
     0	jr promotions
   423	symbols
  6144	bytes

  2860	macro calls
  3807	macro bytes
     0	invented symbols
