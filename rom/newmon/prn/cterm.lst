		;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
		; Terminal mode - shuttle I/O between H19 and serial port
		; since both ports operate at the same speed, don't need
		; to check ready as often.
		
			maclib	ram
**** ram.lib ****
**** cterm.asm ****
			maclib	core
**** core.lib ****
**** cterm.asm ****
			maclib	z80
**** z80.lib ****
**** cterm.asm ****
		
000D          	CR	equ	13
007F          	DEL	equ	127
		
1000          		org	1000h
1000  01      	first:	db	HIGH (last-first)	; +0: num pages
1001  10      		db	HIGH first		; +1: ORG page
1002  FF00    		db	255,0	; +2,+3: phy drv base, num
		
1004  C31510  		jmp	init	; +4: init entry
1007  C31710  		jmp	exec	; +7: action entry
		
100A  54      		db	'T'	; +10: Command letter
100B  FF      		db	-1	; +11: front panel key
100C  00      		db	0	; +12: port, 0 if variable
100D  FFFFFF  		db	11111111b,11111111b,11111111b	; +13: FP display
1010  5465726D		db	'Term',0	; +16: mnemonic string
      00
		
1015  AF      	init:	xra	a
1016  C9      		ret
		
1017          	exec:
1017  216B10  		lxi	h,terms
101A  CD4400  		call	msgout
101D  CD5F10  		call	waitcr
1020          	termfl:
1020  DBED    		in	0edh
1022  E660    		ani	01100000b
1024  FE60    		cpi	01100000b
1026  20F8    		jrnz	termfl	; wait for output to flush
1028  DBEB    		in	0ebh
102A  F680    		ori	10000000b
102C  D3EB    		out	0ebh
102E  D3DB    		out	0dbh
1030  DBE8    		in	0e8h
1032  D3D8    		out	0d8h
1034  DBE9    		in	0e9h
1036  D3D9    		out	0d9h
1038  DBEB    		in	0ebh
103A  E67F    		ani	01111111b
103C  D3EB    		out	0ebh
103E  D3DB    		out	0dbh
1040  AF      		xra	a
1041  D3D9    		out	0d9h
1043  DBD8    		in	0d8h
1045  3E0F    		mvi	a,00fh
1047  D3DC    		out	0dch
1049          	termlp:
1049  DBDD    		in	0ddh
104B  E601    		ani	00000001b
104D  2804    		jrz	terml0
104F  DBD8    		in	0d8h
1051  D3E8    		out	0e8h
1053          	terml0:
1053  DBED    		in	0edh
1055  E601    		ani	00000001b
1057  28F0    		jrz	termlp
1059  DBE8    		in	0e8h
105B  D3D8    		out	0d8h
105D  18EA    		jr	termlp
		
105F          	waitcr:
105F  CD4A00  		call	conin
1062  FE0D    		cpi	CR
1064  C8      		rz
1065  FE7F    		cpi	DEL
1067  20F6    		jrnz	waitcr
1069  E1      		pop	h	; discard ret adr
106A  C9      		ret		; return to monitor
		
106B  65726D69	terms:	db	'erminal Mode',0
      6E616C20
      4D6F6465
      00
		
1078  FFFFFFFF		rept	(($+0ffh) and 0ff00h)-$
      FFFFFFFF
      FFFFFFFF
      FFFFFFFF
      FFFFFFFF
      FFFFFFFF
      FFFFFFFF
      FFFFFFFF
      FFFFFFFF
      FFFFFFFF
      FFFFFFFF
      FFFFFFFF
      FFFFFFFF
      FFFFFFFF
      FFFFFFFF
      FFFFFFFF
      FFFFFFFF
      FFFFFFFF
      FFFFFFFF
      FFFFFFFF
      FFFFFFFF
      FFFFFFFF
      FFFFFFFF
      FFFFFFFF
      FFFFFFFF
      FFFFFFFF
      FFFFFFFF
      FFFFFFFF
      FFFFFFFF
      FFFFFFFF
      FFFFFFFF
      FFFFFFFF
      FFFFFFFF
      FFFFFFFF
0000          	if ($ > 1800h)
		endif
		
1100          	last:	end



Statistics:

     4	passes
     0	jr promotions
    81	symbols
   256	bytes

   151	macro calls
  3759	macro bytes
     0	invented symbols
