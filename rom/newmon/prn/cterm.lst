		;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
		; Terminal mode - shuttle I/O between H19 and serial port
		; since both ports operate at the same speed, don't need
		; to check ready as often.
		
			maclib	ram
**** ram.lib ****
**** cterm.asm ****
			maclib	core
**** core.lib ****
**** cterm.asm ****
			maclib	z80
**** z80.lib ****
**** cterm.asm ****
		
000D          	CR	equ	13
007F          	DEL	equ	127
		
1000          		org	1000h
1000  01      	first:	db	HIGH (last-first)	; +0: num pages
1001  10      		db	HIGH first		; +1: ORG page
1002  FF00    		db	255,0	; +2,+3: phy drv base, num
		
1004  C31510  		jmp	init	; +4: init entry
1007  C31710  		jmp	exec	; +7: action entry
		
100A  54      		db	'T'	; +10: Command letter
100B  FF      		db	-1	; +11: front panel key
100C  00      		db	0	; +12: port, 0 if variable
100D  FFFFFF  		db	11111111b,11111111b,11111111b	; +13: FP display
1010  5465726D		db	'Term',0	; +16: mnemonic string
      00
		
1015  AF      	init:	xra	a
1016  C9      		ret
		
1017          	exec:
1017  216E10  		lxi	h,terms
101A  CD4400  		call	msgout
101D  CD6210  		call	waitcr
1020  CD1B00  		call	crlf
1023          	termfl:
1023  DBED    		in	0edh
1025  E660    		ani	01100000b
1027  FE60    		cpi	01100000b
1029  20F8    		jrnz	termfl	; wait for output to flush
102B  DBEB    		in	0ebh
102D  F680    		ori	10000000b
102F  D3EB    		out	0ebh
1031  D3DB    		out	0dbh
1033  DBE8    		in	0e8h
1035  D3D8    		out	0d8h
1037  DBE9    		in	0e9h
1039  D3D9    		out	0d9h
103B  DBEB    		in	0ebh
103D  E67F    		ani	01111111b
103F  D3EB    		out	0ebh
1041  D3DB    		out	0dbh
1043  AF      		xra	a
1044  D3D9    		out	0d9h
1046  DBD8    		in	0d8h
1048  3E0F    		mvi	a,00fh
104A  D3DC    		out	0dch
104C          	termlp:
104C  DBDD    		in	0ddh
104E  E601    		ani	00000001b
1050  2804    		jrz	terml0
1052  DBD8    		in	0d8h
1054  D3E8    		out	0e8h
1056          	terml0:
1056  DBED    		in	0edh
1058  E601    		ani	00000001b
105A  28F0    		jrz	termlp
105C  DBE8    		in	0e8h
105E  D3D8    		out	0d8h
1060  18EA    		jr	termlp
		
1062          	waitcr:
1062  CD4A00  		call	conin
1065  FE0D    		cpi	CR
1067  C8      		rz
1068  FE7F    		cpi	DEL
106A  20F6    		jrnz	waitcr
106C  E1      		pop	h	; discard ret adr
106D  C9      		ret		; return to monitor
		
106E  65726D69	terms:	db	'erminal Mode',0
      6E616C20
      4D6F6465
      00
		
107B  FFFFFFFF		rept	(($+0ffh) and 0ff00h)-$
      FFFFFFFF
      FFFFFFFF
      FFFFFFFF
      FFFFFFFF
      FFFFFFFF
      FFFFFFFF
      FFFFFFFF
      FFFFFFFF
      FFFFFFFF
      FFFFFFFF
      FFFFFFFF
      FFFFFFFF
      FFFFFFFF
      FFFFFFFF
      FFFFFFFF
      FFFFFFFF
      FFFFFFFF
      FFFFFFFF
      FFFFFFFF
      FFFFFFFF
      FFFFFFFF
      FFFFFFFF
      FFFFFFFF
      FFFFFFFF
      FFFFFFFF
      FFFFFFFF
      FFFFFFFF
      FFFFFFFF
      FFFFFFFF
      FFFFFFFF
      FFFFFFFF
      FFFFFFFF
      FF
0000          	if ($ > 1800h)
		endif
		
1100          	last:	end



Statistics:

     4	passes
     0	jr promotions
    81	symbols
   256	bytes

   148	macro calls
  3759	macro bytes
     0	invented symbols
